const e={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null};Object.values(e);const t={object:Object,array:Array};Object.values(t);const n=Object.assign({},e,t);Object.values(n);var s=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();const r={depth:0,maxDepth:10,accessors:[{default:(e,t)=>void 0===t?e:e[t]}.default],ancestors:[]};function i(e,t){const n=[],s=Object.assign({},r,t,{ancestors:[].concat(t.ancestors)});if(s.depth++,s.depth>s.maxDepth)return n;for(const t of s.accessors){const r=t.bind(e)(e);if(r){s.ancestors.includes(r)||s.ancestors.unshift(r);for(const[e,t]of Object.entries(r))if(s.values?s.values&&n.push([e,t]):n.push(e),"object"==typeof t&&null!==t&&!Object.is(t,r)&&!s.ancestors.includes(t)){const r=i(t,s);if(s.values){if(s.values)for(const[t,s]of r){const r=[e,t].join(".");n.push([r,s])}}else for(const t of r){const s=[e,t].join(".");n.push(s)}}}}return n}function o(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,r]of Object.entries(n)){const n=s(e[t]),i=s(r);e[t]="object"===n&&"object"===i?o(e[t],r):r}return e}var a={default:(e,t)=>void 0===t?e:e[t]};function c(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var s=e.substr(0,t),r=e.substr(t+2);if(s.length>0&&r.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function l(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,s=0,r=0,i=-1,o=[""],a=[],u=0;u<e.length;u++){var p=e[u];if("\\"!==p){if("{"===p)if(n)s++;else if(u>i&&!s){t=e.substring(i+1,u);for(var h=0;h<o.length;h++)o[h]+=t;a=[],i=u,n=!0,s++}else s--;else if("}"===p)if(n)r++;else if(1===r){if(t=e.substring(i+1,u),a.length>0){var d=[];a.push(l(t));for(h=0;h<o.length;h++)for(var f=0;f<a.length;f++)for(var v=0;v<a[f].length;v++)d.push(o[h]+a[f][v]);o=d}else{t=c(t);for(h=0;h<o.length;h++)o[h]+=t}i=u,r--}else r--;else n||","!==p||r-s!==1||(t=e.substring(i+1,u),a.push(l(t)),i=u);!n||r!==s&&u!==e.length-1||(n=!1,u=i-1)}else u++}if(-1===i)return[e];var g="{"===e[i]?i:i+1;if(g<e.length){t=e.substr(g);for(h=0;h<o.length;h++)o[h]+=t}return o}function u(e,t){var n,s=!1!==t["!"],r=!1!==t["()"],i=!1;if(s){for(n=0;n<e.length&&"!"===e[n];n++){if(r&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function p(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function h(e,t,n){var s=void 0===t.separator||t.separator,r="",i="",o=".";!0===s?(r="/",i="[/\\\\]",o="[^/\\\\]"):o=s?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=p(e[n]);return t}(r=s)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var a=s?i+"+?":"",c=s?i+"*?":"",l=s?e.split(r):[e];return{source:e,segments:l,options:t,separator:s,separatorSplitter:r,separatorMatcher:i,optionalSeparator:c,requiredSeparator:a,wildcard:o,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:s&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function d(e,t,n,s){return{source:e,isFirst:n,isLast:s,end:e.length-1}}var f="(?!\\.)";function v(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=f+t),e.dotHandled=!0,e.result.match+=t),e.result}function g(e,t,n){var s=e.support,r=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(s.excludeDot||(r.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:v(r,i);if(s.globstar&&"**"===t.source)return v(r,"(?:"+((r.dotHandled?"":f)+e.wildcard+"*?"+i)+")*?");for(;++r.i<=t.end;){if(r.char=r.segment.source[r.i],r.nextChar=r.i<t.end?t.source[r.i+1]:"","\\"===r.char){if(r.i<r.segment.end){r.escapeChar=!0;continue}r.char=""}e=r.pattern,t=r.segment;var o=r.char,a=r.i;if(e.support.brackets&&!r.scanningForParens){if(a>r.openingBracket&&a<=r.closingBracket){r.escapeChar?v(r,p(o)):a===r.closingBracket?(v(r,"]"),r.openingBracket=t.source.length):"-"===o&&a===r.closingBracket-1?v(r,"\\-"):"!"===o&&a===r.openingBracket+1?v(r,"^"):v(r,"]"===o?"\\]":o),r.escapeChar=!1;continue}if(a>r.openingBracket){"]"===o&&!r.escapeChar&&a>r.openingBracket+1&&a>r.closingBracket?(r.closingBracket=a,r.i=r.openingBracket,e.separator?v(r,"(?!"+e.separatorMatcher+")[",!0):v(r,"[",!0)):a===t.end&&(v(r,"\\["),r.i=r.openingBracket,r.openingBracket=t.source.length,r.closingBracket=t.source.length),r.escapeChar=!1;continue}if("["===o&&!r.escapeChar&&a>r.closingBracket&&a<t.end){r.openingBracket=a,r.escapeChar=!1;continue}}if(r.pattern.support.extglobs){var c=r.extglobModifiers,l=(o=r.char,r.nextChar);a=r.i;if("("!==l||r.escapeChar||"@"!==o&&"?"!==o&&"*"!==o&&"+"!==o&&"!"!==o){if(")"!==o||r.escapeChar){if("|"===o&&r.closingParens&&!r.scanningForParens&&!r.escapeChar){v(r,"|");continue}}else if(r.scanningForParens)r.closingParens++;else if(c.length){var u=c.pop();if("!"===u&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");v(r,")"+(u="!"===u||"@"===u?"":u)),r.addToMatch=!0,r.addToUnmatch=!0,r.closingParens--;continue}}else if(r.scanningForParens)r.openingParens++;else if(a>r.parensHandledUntil&&!r.closingParens)r.parensHandledUntil=a,r.scanningForParens=!0,r.openingParens++;else{if(r.closingParens>=r.openingParens){"!"===o&&(r.addToMatch=!0,r.addToUnmatch=!1,v(r,r.pattern.wildcard+"*?",!0),r.addToMatch=!1,r.addToUnmatch=!0,r.result.useUnmatch=!0),c.push(o),v(r,"(?:",!0),r.openingParens--,r.i++;continue}r.openingParens--}if(r.scanningForParens){r.closingParens!==r.openingParens&&a!==r.segment.end||(r.scanningForParens=!1,r.i=r.parensHandledUntil-1),r.escapeChar=!1;continue}}s=(e=r.pattern).support;!r.escapeChar&&s.star&&"*"===r.char?r.i!==r.segment.end&&"*"===r.nextChar||v(r,e.wildcard+"*?",!0):!r.escapeChar&&s.qMark&&"?"===r.char?v(r,e.wildcard,!0):v(r,p(r.char)),r.escapeChar=!1}return v(r,i)}function y(e,t,n){for(var s=h(e,t,n),r={match:"",unmatch:"",useUnmatch:!1},i=s.segments,o=0;o<i.length;o++){g(s,d(i[o],0,0===o,o===i.length-1),r)}return r.useUnmatch?"(?!^"+r.unmatch+"$)"+r.match:r.match}function b(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function m(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],s=0;s<e.length;s++)for(var r=t(e[s]),i=0;i<r.length;i++)n.push(r[i]);return n}(e,l));for(var n=[],s=[],r="",i=0;i<e.length;i++){var o=u(e[i],t),a=y(o.pattern,t,!o.isNegated);o.isNegated?s.push(a):n.push(a)}return s.length&&(r="(?!(?:"+s.join("|")+")$)"),n.length>1?r+="(?:"+n.join("|")+")":1===n.length?r+=n[0]:r.length&&(r+=y("**",t,!0)),"^"+r+"$"}(e,t),s=new RegExp(n,t.flags),r=b.bind(null,s);return r.options=t,r.pattern=e,r.regexp=s,r}class j{#e;#t=!1;#n=[];#s=[];#r;#i;#o;constructor(e,t){if(!e||!t)return this;const n=((e={})=>{const t={enable:!1,assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,errorLog:!1,methods:{assign:{addEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:o}=r;return t.addEventListener(n,s,i||o)},on:function(e,t){const{type:n,listener:s}=e;return t.on(n,s)},once:function(e,t){const{type:n,listener:s}=e;return t.once(n,s)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:o}=r;return t.removeEventListener(n,s,i||o)},off:function(e,t){const{type:n,listener:s}=e;return t.off(n,s)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...s){return t.emit(n,...s)}}}};for(const[n,s]of Object.entries(e))switch(n){case"methods":t[n]=o(t[n],s);break;case"enableEvents":break;default:t[n]=s}return t})(e);Object.defineProperties(this,{settings:{value:n},path:{value:n.path},type:{value:n.type},assigned:{value:[]},deassigned:{value:[]},transsigned:{value:[]},listener:{configurable:!0,get(){let e;if("string"===s(n.listener)){let r=t;e:for(const e of n.listener.split(".")){if(void 0===r[e])break e;r=r[e]}"function"===s(r)&&(e=r)}else e=n.listener;return!0===n.bindListener&&(e=e.bind(this.#e)),Object.defineProperty(this,"listener",{value:e}),e}}}),this.#e=t,this.enable=this.settings.enable}get enable(){return this.#t}set enable(e){const t=this.#a,n=this.assigned,s=this.deassigned;n.length=0,s.length=0;for(const r of t){const{path:t,target:i,enable:o}=r;if(this.settings,o!==e)if(!0===e)try{this.#c(i),r.enable=e,n.push(r)}catch(e){this.settings.errorLog&&console.error(e)}else if(!1===e)try{this.#l(i),r.enable=e,s.push(r)}catch(e){this.settings.errorLog&&console.error(e)}}this.#t=e}get#u(){return this.settings.target}get#a(){const e=this.#s,t=[];if(this.#u)for(const n of[].concat(this.#u)){const s=e.find((e=>e?.path===this.path));void 0!==s?t.push(s):void 0===s&&ptargets.push({path:this.path,target:n,enable:!1})}else if("string"===s(this.path)){const n=[];if(this.path===this.#p){const e={path:this.path,target:this.#e,enable:!1};t.push(e)}else{if(this.settings.propertyDirectory){const e=this.#h,t=m(this.path,{separator:"."});for(const[s,r]of e){!0===t(s)&&n.push([s,r])}"*"===this.path.charAt(0)&&n.unshift([this.#p,this.#e])}else n.push(this.path);for(const[s,r]of n){const n=e.find((e=>e.path===s));let i,o=r;void 0!==o&&(o===n?.target?i=n:"object"==typeof o&&(i={path:s,target:o,enable:!1})),void 0!==i&&t.push(i)}}}return this.#s=t,this.#s}get#p(){return this.settings.propertyDirectory.scopeKey}get#c(){return void 0!==this.#r||(this.#r=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#r}get#l(){return void 0!==this.#i||(this.#i=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#i}get#d(){return void 0!==this.#o||(this.#o=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#o}get#h(){if(!this.settings.propertyDirectory)return null;const e=Object.assign(this.settings.propertyDirectory,{values:!0});return i(this.#e,e)}emit(){const e=this.#a,t=this.transsigned,n=this.#n;t.length=0,n.length=0;for(const s of e){const{target:e}=s;try{this.#d(e,...arguments),t.push(s)}catch(e){n.push(s)}}return this}}class O extends EventTarget{static implement=function(e,t){if(!e||!t)return;const n=((e={})=>{const t={events:{},enableEvents:!1,propertyDirectory:{accessors:[a.default],scopeKey:":scope",maxDepth:10},propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents",emitEvents:"emitEvents"}};for(const[n,s]of Object.entries(e))switch(n){case"propertyDefinitions":case"propertyDirectory":t[n]=Object.assign(t[n],s);break;default:t[n]=s}return t})(t),s=[];return Object.defineProperties(e,{[n.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments[0])return s;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of s){let s;e:for(const[e,r]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===r:t[e]===r,!1===s)break e;s=n}!0===s&&e.push(t)}return e}},[n.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return e;let t=function(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[s,r]of Object.entries(e)){const e=s.trim().split(" ");let i,o,a;1===e.length?(i=t,o=e[0]):e.length>1&&(i=e[0],o=e[1]),Array.isArray(r)?(a=r[0],r[1]):a=r;const c={type:o,path:i,listener:a,enable:!1};n.push(c)}return n}(arguments[0],n.propertyDirectory.scopeKey),r=arguments[1]||!1;for(let i of t){const t={};for(const e of["assign","deassign","transsign","propertyDirectory","bindListener"]){const s=n[e];void 0!==s&&(t[e]=s)}o(t,i);const a=new j(t,e);r&&(a.enable=!0),s.push(a)}return e}},[n.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;let r=s.length-1;for(;r>-1;){const e=s[r];t.includes(e)&&(e.enable=!1,s.splice(r,1)),r--}return e}},[n.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!0;return e}},[n.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!1;return e}},[n.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);for(const e of t)e.enable=!1,e.enable=!0;return e}},[n.propertyDefinitions.emitEvents]:{enumerable:!1,writable:!1,value:function(t,...s){const r=e[n.propertyDefinitions.getEvents](t);for(const e of r)e.emit(...s);return e}}}),n.events&&e[n.propertyDefinitions.addEvents](n.events),!0===n.enableEvents&&e[n.propertyDefinitions.enableEvents](),e};constructor(e={}){return super(),O.implement(this,e)}}const E={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null};Object.values(E);const w={object:Object,array:Array};Object.values(w);const P=Object.assign({},E,w);Object.values(P);var x=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function k(e){let t;const n=x(e);if("string"===n){const n=e.toLowerCase();"object"===n?t={}:"array"===n&&(t=[])}else"object"===n?t={}:"array"===n&&(t=[]);return t}function S(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=x(e[t]),r=x(s);e[t]="object"===n&&"object"===r?S(e[t],s):s}return e}var $=e=>Object.assign({},e),A=e=>Object.assign({parent:null,path:null,enableEvents:!0,definition:null,propertyClasses:[]},e);class C extends O{static propertyClasses=[];constructor(e={},t={}){super(Object.assign({},t,{propertyDirectory:{accessors:[function(e,t){return void 0===t?e:e[t]},function(e,t){if(e instanceof Map==!0)return void 0===t?Object.fromEntries(e):e.get(t)},function(e,t){return void 0===t?e.target:e.target[t]}]}}));const n=[];let s=null,r=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,i=n?n.split(".").pop():n;s&&s.unmount(i),s=t,r=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{settings:{value:$(e)},options:{value:A(t)},definition:{get:()=>definition},parent:{get:()=>s},path:{get:()=>r},key:{get:()=>r?r.pop():r},root:{get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},retroReenableEvents:{value:function(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}},addPropertyClasses:{value:function(){const e=this;let t=0===arguments.length?this.options.propertyClasses:[].concat(...arguments);e:for(const s of t){if(!s.targetType){n.push(s);continue e}const{name:t,administer:r,deadminister:i,instate:o,deinstate:a,targetType:c,definition:l}=s;Object.defineProperties(this,{[t]:{configurable:!0,enumerable:!0,writable:!0,value:k(c)},[r]:{configurable:!0,enumerable:!1,writable:!1,value:function(n){e[t]||(e[t]=k(c));for(const[r,i]of Object.entries(n))e[t][r]=o(e,r,i,s),e.retroReenableEvents();return e}},[i]:{configurable:!0,enumerable:!1,writable:!1,value:function(...n){let r;r=0===n.length?Object.keys(e[t]).reverse():[].concat(...n).reverse();for(const n of r)a(e,n,s),delete e[t][n],e.retroReenableEvents();return e}}}),n.push(s)}return this}},removePropertyClasses:{value:function(...e){let t;t=0===e.length?n.reduce(((e,t)=>(e.push($propertyClass.name),e)),[]):[].concat(...e);for(const e of t){const t=n.findIndex((t=>t.name===e)),{name:s,deadminister:r}=n.splice(t,1)[0];this[r](),delete this[s]}return this}}}),this.settings.defineProperties&&Object.defineProperties(this,this.settings.defineProperties),this.settings.assign&&Object.assign(this,this.settings.assign),this.options.propertyClasses&&this.addPropertyClasses(this.options.propertyClasses),this.mount({parent:this.options.parent,path:this.options.path}),(e=>{n.map((e=>e.name));for(const t of n){const{administer:n,name:s,targetType:r}=t;r&&(void 0!==e[s]&&(void 0!==r?this[n](this.settings[s]):void 0!==this.settings[s]&&(this[s]=this.settings[s])))}})(this.settings)}}const T={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null},D=Object.keys(T),R=Object.values(T),_={object:Object,array:Array},I=Object.keys(_),q=Object.values(_),L=Object.assign({},T,_),V=Object.keys(L),N=Object.values(L),B=[T.String,T.Number,T.Boolean,_.Object,_.Array];var M=Object.freeze({__proto__:null,ObjectKeys:I,ObjectValues:q,Objects:_,PrimitiveKeys:D,PrimitiveValues:R,Primitives:T,TypeKeys:V,TypeMethods:B,TypeValues:N,Types:L}),z=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function U(e){let t;const n=z(e);if("string"===n){const n=e.toLowerCase();"object"===n?t={}:"array"===n&&(t=[])}else"object"===n?t={}:"array"===n&&(t=[]);return t}var K=/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/;function W(e,t){const n=e.split(new RegExp(K)),s=n.pop();let r=t;for(const e of n)r=r[e];return r[s]}function F(e,t){const n=z(t),s=z(e);if(!["string","function"].includes(n)||!["array","object"].includes(s))return e;let r=U(e);for(const[s,i]of Object.entries(e))"string"===n?r[s]=W(t,i):"function"===n&&(r[s]=t(i)),r[s]&&"object"==typeof r[s]&&(r[s]=F(r[s],t));return r}function H(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=z(e[t]),r=z(s);e[t]="object"===n&&"object"===r?H(e[t],s):s}return e}var Q={depth:0,path:null,ancestors:[]},J={delimiter:".",maxDepth:10,path:!1,retrocursion:!1,type:!1};function G(e,t,n){const s=Object.assign({},Q,J,n,{ancestors:Object.assign([],n.ancestors)}),r=Object.getOwnPropertyDescriptor(e,t);if(s.ancestors.includes(e)||s.ancestors.unshift(e),s.retrocursion||!s.ancestors.includes(r.value))return s.path&&(s.path="string"===z(s.path)?[s.path,t].join(s.delimiter):t,r.path=s.path),s.type&&(r.type=z(r.value)),["array","object"].includes(z(r.value))&&(r.value=X(r.value,s)),r}function X(e,t){const n={},s=Object.assign({},Q,J,t);if(s.depth>=s.maxDepth)return n;s.depth++;for(const[t,r]of Object.entries(Object.getOwnPropertyDescriptors(e))){const r=G(e,t,s);void 0!==r&&(n[t]=r)}return n}var Y={typeCoercion:!1};function Z(e,t,n,s){const r=Object.assign({},n),i=Object.assign({},Y,s),o=z(r.value);if(["array","object"].includes(o)){const e=(e=>{let t;const n=z(e);if("array"===n)t=!0;else if("object"===n&&Number.isInteger(e.length)&&e.length>=0){e:for(const n of Object.keys(Object.getOwnPropertyDescriptors(e)))if("length"!==n&&(t=!isNaN(n),!t))break e}else t=!1;return t})(Object.defineProperties(U(o),r.value))?[]:{};r.value=ee(e,r.value,i)}else i.typeCoercion&&void 0!==Object.getOwnPropertyDescriptor(r,"type")&&!["undefined","null"].includes(o)&&(r.value=T[r.type](r.value));return Object.defineProperty(e,t,r),e}function ee(e,t,n){const s=Object.assign({},Y,n);for(const[n,r]of Object.entries(t))Z(e,n,r,s);return e}class te extends EventTarget{#f=localStorage;#v;constructor(e){super(),this.path=e}get path(){return this.#v}set path(e){void 0===this.#v&&(this.#v=e)}get(){let e=this.#f.getItem(this.path);return e&&(e=ee(JSON.parse(e),{typeCoercion:!0})),e}set(e){return this.#f.setItem(this.path,JSON.stringify(X(e,{path:!0,retrocursion:!1,type:!0})))}remove(){try{return this.#f.removeItem(this.path)}catch(e){console.error(e)}}}let ne=class extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}};const se={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function re(e="expand",t){const n=t||this,s=n.schema,r=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=U(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const r of s)t[n.key][r.type]={},r.validation?t[n.key][r.type]=this.report(e,r.validation):t[n.key][r.type]=r}return t}if("impand"===e){if(!1===n.valid)return!1;const t=U(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);let r;e:for(const t of s)if("type"===t.type){t.validation&&n.valid&&(r=this.report(e,t.validation));break e}r||(r=n.valid),t[n.key]=r}return t}}let ie=class extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:se},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=re.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}};const oe={true:e=>`${e.pass}`,false:e=>`${e.pass}`};let ae=class extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:oe},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,s){const{definition:r,messages:i,type:o}=this;let a=new ne({type:o,key:e,value:r.value,messages:H({},i,r.messages)});const c=r.validate(...arguments);return"object"==typeof c?(a.validation=c,a.pass=c.valid):a.pass=c,a}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}};class ce extends ae{constructor(e,t){super(Object.assign({},e,{type:"required",validate:(e,n,s,r)=>{const{requiredProperties:i,requiredPropertiesSize:o,type:a}=t,c=Object.assign({},i);let l,u=o;if(Object.assign(U(a),s,r),this.definition,o){if(Object.hasOwn(c,e)&&(delete c[e],u--),u){const e=new ye(c,{path:t.path,parent:t.parent}),n=Object.assign({},r,s);l=e.validate(n).valid}}else l=!0;return l}}),t)}}const{ObjectKeys:le,TypeKeys:ue}=M;class pe extends ae{constructor(e={},t){super(Object.assign({},e,{type:"type",validate:(e,t,n,s)=>{let r;const i=this.definition;let o=z(i.value);if(o="function"===o?z(i.value()):i.value instanceof ye?i.value.type:z(i.value),ue.includes(o)){const e=z(t);if("undefined"===e)r=!1;else if("undefined"===o)r=!0;else if(i.value instanceof ye){r=i.value.validate(t,n)}else r=o===e}else r=!1;return r}}),t)}}class he extends ae{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let s;if("number"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,o;i=void 0===e||t>=e.value,o=void 0===r||t<=r.value,s=!(!i||!o)}return s}}),t)}}class de extends ae{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let s;if("string"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,o;i=void 0===e||t.length>=e.value,o=void 0===r||t.length<=r.value,s=!(!i||!o)}return s}}),t)}}class fe extends ae{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let s;if(["string","number","boolean"].includes(typeof t)){s=n.value.includes(t)}else s=!1;return s}}),t)}}class ve extends ae{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let s;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else s=!1;return!!s}}),t)}}var ge=(...e)=>Object.assign({required:!1,verificationType:"all",strict:!1,properties:{type:"type",value:"value"}},...e);class ye extends EventTarget{constructor(e={},t={}){super(),Object.defineProperties(this,{options:{value:ge(t)},type:{value:z(e)},parent:{configurable:!0,get(){const{options:e}=this,t=e.parent?e.parent:null;return Object.defineProperty(this,"parent",{value:t}),t}},root:{configurable:!0,get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},key:{configurable:!0,get(){const{path:e}=this,t=e?e.split(".").pop():null;return Object.defineProperty(this,"key",{value:t}),t}},path:{configurable:!0,get(){const{options:e}=this,t=e.path?String(e.path):null;return Object.defineProperty(this,"path",{value:t}),t}},required:{configurable:!0,get(){const e=this.options.required;return Object.defineProperty(this,"required",{value:e}),e}},requiredProperties:{configurable:!0,get(){const e=U(this.type);for(const[t,n]of Object.entries(this.target))!0===n.required?.value&&(e[t]=n);return Object.defineProperty(this,"requiredProperties",{value:Object.freeze(e)}),e}},requiredPropertiesSize:{configurable:!0,get(){const e=Object.keys(this.requiredProperties).length;return Object.defineProperty(this,"requiredPropertiesSize",{value:e}),e}},verificationType:{configurable:!0,get(){const e=this.options.verificationType;return Object.defineProperty(this,"verificationType",{value:e}),e}},target:{configurable:!0,get(){let t;const n=this.type;"array"===n?t=e.slice(0,1):"object"===n&&(t=e);const s=function(e,t){const n=U(e);if(be(e,t))return e;for(const[s,r]of Object.entries(e)){let e={};z(r);const i=be(r,t);if(M.TypeValues.includes(r))Object.assign(e,{type:{value:r}});else if(M.TypeKeys.includes(r))Object.assign(e,{type:{value:M.Types[r]}});else if(i){if(i)for(const[n,i]of Object.entries(r)){const r=me(i,t);if(r)r&&(e[n]=i);else{let r;if("type"===n)if(i&&"object"==typeof i){const e=t.path?[t.path,s].join("."):s;r=new ye(i,Object.assign({},t.options,{parent:t,path:e}))}else r=i;else r=i;e[n]={type:n,value:r}}}}else{const n=t.path?[t.path,s].join("."):s;Object.assign(e,{type:{type:"type",value:new ye(r,Object.assign({},t.options,{parent:t,path:n}))}})}e.validators=[],n[s]=e;const o=new Map;o.set("type",Object.assign({},{type:"type",validator:pe,value:e.type.value})),o.set("required",Object.assign({},{type:"required",validator:ce,value:e.required?.value||!1})),e.range?o.set("range",Object.assign({},e.range,{type:"range",validator:he})):(e.min||e.max)&&o.set("range",Object.assign({},{type:"range",min:e.min,max:e.max,validator:he})),e.length?o.set("length",Object.assign({},e.length,{type:"length",validator:de})):(e.minLength||e.maxLength)&&o.set("length",Object.assign({},{type:"length",min:e.minLength,max:maxLength,validator:de})),e.enum&&o.set("enum",Object.assign({},e.enum,{type:"enum",validator:fe})),e.match&&o.set("match",Object.assign({},e.match,{type:"match",validator:ve})),delete e.min,delete e.max,delete e.minLength,delete e.maxLength;for(const[n,s]of o.entries()){const r=s.validator;e[n]=s,e.validators.push(new r(s,t))}}return n}(t,this);return Object.defineProperty(this,"target",{value:s}),s}},validate:{value:function(...e){let{$sourceName:t,$source:n,$target:s}=function(...e){let t,n,s;1===e.length?(t=null,n=e.shift(),s=null):2===e.length?["number","string"].includes(typeof e[0])?(t=e.shift(),n=e.shift(),s=null):e[0]&&"object"==typeof e[0]&&(t=null,n=e.shift(),s=e.shift()):3===e.length&&["number","string"].includes(typeof e[0])&&(t=e.shift(),n=e.shift(),s=e.shift());return{$sourceName:t,$source:n,$target:s}}(...e);s=s||U(n);const{target:r,path:i,required:o,type:a,verificationType:c}=this;let l=new ie({required:o,verificationType:c,definition:r,key:t,value:n},this);const u=Object.entries(n);let p=0;for(;p<u.length;){const[e,t]=u[p],r=this.validateProperty(e,t,n,s);!0===r.valid?l.advance.push(r):!1===r.valid?l.deadvance.push(r):void 0===r.valid&&l.unadvance.push(r),p++}return l.advance.length?l.valid=!0:l.deadvance.length?l.valid=!1:l.unadvance.length?l.valid=void 0:l.valid=!0,l}},validateProperty:{value:function(){const{$key:e,$value:t,$source:n,$target:s}=function(...e){let[t,n,s,r]=e;return{$key:t,$value:n,$source:s,$target:r}}(...arguments),{target:r,path:i,required:o,schema:a,type:c,verificationType:l}=this;let u;"array"===c?u=r[0]:"object"===c&&(u=r[e]);const p=new ie({required:o,verificationType:l,definition:u,key:e,value:t},this);if(void 0===u){const n=new ne({type:null,definition:null,key:e,value:t},this);n.pass=!1,p.unadvance.push(n)}else e:for(const[r,i]of Object.entries(u.validators)){const r=i.validate(e,t,n,s);if(!0===r.pass?p.advance.push(r):!1===r.pass?p.deadvance.push(r):void 0===r.pass&&p.unadvance.push(r),"one"===this.verificationType&&p.deadvance.length)break e}return p.deadvance.length?p.valid=!1:p.advance.length?p.valid=!0:p.unadvance.length&&(p.valid=!1),p}}})}}function be(e,t){if(!e||e instanceof ye)return!1;const n=t.options.properties.type;return Object.hasOwn(e,n)}function me(e,t){if(!e)return!1;const n=t.options.properties.value;return Object.hasOwn(e,n)}class je extends CustomEvent{constructor(e,t,n){super(e,t),Object.defineProperties(this,{model:{get:()=>n},key:{configurable:!0,get(){const e=this.path?this.path.split(".").pop():null;return Object.defineProperty(this,"key",{value:e}),e}},change:{configurable:!0,get(){const e=t.change;return Object.defineProperty(this,"change",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},path:{configurable:!0,get(){const e=t.path;return Object.defineProperty(this,"path",{value:e}),e}},detail:{configurable:!0,get(){const e=t.detail;return Object.defineProperty(this,"detail",{value:e}),e}}})}}class Oe{#g=!1;#y=!1;#b=!1;#m=!1;#j;#O;#E;#w;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#O}set preter(e){if(!0===this.#y)return this.#O;this.#O=e?.valueOf(),this.#y=!0}get anter(){return this.#E}set anter(e){if(!0===this.#b)return this.#E;this.#E=e?.valueOf(),this.#b=!0}get conter(){if(!0===this.#m||[this.#y,this.#b].includes(!1))return this.#w;const e=JSON.stringify(this.preter);let t;return t=JSON.stringify(this.anter)!==e,this.#w=t,this.#m=!0,this.#w}}let Ee=class extends CustomEvent{constructor(e,t,n){super(e),Object.defineProperties(this,{key:{configurable:!0,get(){const e=t.key;return Object.defineProperty(this,"key",{value:e}),e}},path:{configurable:!0,get(){const e=n.path?[n.path,t.key].join("."):t.key;return Object.defineProperty(this,"path",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},valid:{configurable:!0,get(){const e=t.valid;return Object.defineProperty(this,"valid",{value:e}),e}}})}};var we={assign:function(e,t,...n){const s=Object.assign({},t),r=s.assignArray||"assign",{path:i,schema:o,source:a,target:c}=e,{enableValidation:l,mutatorEvents:u,required:p,sourceTree:h,validationEvents:d}=s,f=[],v=new Oe({preter:e});for(let t of n){let n;const a=new Oe({preter:e});let p;Array.isArray(t)?n=[]:t&&"object"==typeof t&&(n={}),l&&o&&(p=o.validate(t,e.valueOf()),p.report());e:for(let[a,p]of Object.entries(t)){const f=new Oe({preter:c[a]}),v=new Oe({preter:c[a]});if(o&&l){const n=e.valueOf(),s=t,r=o.validateProperty(a,p,s,n);if(d){let t,n;r.valid?(t="validProperty",n=["validProperty",a].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",a].join(":"));for(const s of[t,n])e.dispatchEvent(new Ee(s,r,e))}if(!r.valid)continue e}let g;if(p&&"object"==typeof p){let t;p instanceof e.constructor&&(g=p.valueOf()),t="array"===o?.type?o.target[0].type.value:"object"===o?.type?o.target[a].type.value:null;const l=i?[i,a].join("."):String(a);if(!1===h){const r=H({},s,{path:l,parent:e});g=new e.constructor(p,t,r);const i={[a]:g};Object.assign(c,i),Object.assign(n,i)}else{if(c[a]instanceof e.constructor)g=c[a];else{const n=U(p),r=H({},s,{path:l,parent:e});g=new e.constructor(n,t,r)}const i={[a]:g};Object.assign(c,i),Object.assign(n,i),e.retroReenableEvents(),"array"===g.type?["push","unshift"].includes(r)?g[r](...p):g[r](p):"object"===g.type&&g.assign(p)}}else{g=p;const e={[a]:g};Object.assign(c,e),Object.assign(n,e)}if(u){const t=i?[i,a].join("."):String(a);if(u["assignSourceProperty:$key"]){const s=["assignSourceProperty",a].join(":");v.anter=c[a],e.dispatchEvent(new je(s,{path:t,value:g,change:v,detail:{source:n}},e))}u.assignSourceProperty&&(f.anter=c[a],e.dispatchEvent(new je("assignSourceProperty",{path:t,value:g,change:f,detail:{source:n}},e)))}}f.push(n),u&&u.assignSource&&(a.anter=e,e.dispatchEvent(new je("assignSource",{path:i,change:a,detail:{source:n}},e)))}return u&&u.assign&&(v.anter=e,e.dispatchEvent(new je("assign",{path:i,change:v,detail:{sources:f}},e))),e},defineProperties:function(e,t,n){const{path:s,schema:r}=e;let{enableValidation:i,mutatorEvents:o,required:a,validation:c,validationEvents:l,validationReport:u}=t;const p=Object.entries(n),h=new Oe({preter:e});for(const[n,s]of p)e.defineProperty(n,s,Object.assign({},t,{validation:c,validationReport:u}));return o&&o.defineProperties&&(h.anter=e,e.dispatchEvent(new je("defineProperties",{path:s,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,s){const r=Object.assign({},t),i=r.assignArray||"defineProperties",{descriptorTree:o,enableValidation:a,mutatorEvents:c,validation:l,validationEvents:u,validationReport:p}=r,{target:h,path:d,schema:f}=e,v=s.value,g=(Object.getOwnPropertyDescriptor(h,n)||{}).value,y=new Oe({preter:g}),b=new Oe({preter:g}),m=g instanceof e.constructor;if(f&&a){const t=f.validateProperty(n,F(v,"value")||v,{},e.valueOf());if(u){let s,r;t.valid?(s="validProperty",r=["validProperty",n].join(":")):(s="nonvalidProperty",r=["nonvalidProperty",n].join(":"));for(const n of[s,r])e.dispatchEvent(new Ee(n,t,e))}if(!t.valid)return e}if(v&&"object"==typeof v){const t=d?[d,n].join("."):String(n);if(m)!0===o?g.defineProperties(s):Object.defineProperty(h,n,s);else{let a;f&&(a="array"===f.type?f.target[0].type.value:"object"===f.type?f.target[n].type.value:void 0);let c=U(v);const l=H({},r,{path:t,parent:e}),u=new e.constructor(c,a,l);!0===o?(h[n]=u,e.retroReenableEvents(),"array"===u.type?["push","unshift"].includes(i)?u[i](...v):u[i](v):"object"===u.type&&u.defineProperties(v)):!1===o&&Object.defineProperty(h,n,s)}}else Object.defineProperty(h,n,s);if(c){const t=d?[d,n].join("."):String(n);if(c["defineProperty:$key"]){b.anter=h[n];const r=["defineProperty",n].join(":");e.dispatchEvent(new je(r,{path:t,value:v,change:b,detail:{prop:n,descriptor:s}},e))}c.defineProperty&&(y.anter=h[n],e.dispatchEvent(new je("defineProperty",{path:t,value:v,change:y,detail:{prop:n,descriptor:s}},e)))}return e},freeze:function(e,t){const{recursive:n,mutatorEvents:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof e.constructor&&(n.freeze(),s&&s.freezeProperty&&e.dispatchEvent(new je("freezeProperty",{path:n.path},e)));return Object.freeze(r),s&&s.freeze&&e.dispatchEvent(new je("freeze",{path:e.path},e)),e},seal:function(e,t){const{recursive:n,mutatorEvents:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof e.constructor&&(n.seal(),s&&s.sealProperty&&e.dispatchEvent(new je("sealProperty",{path:n.path},e)));return Object.seal(r),s&&s.seal&&e.dispatchEvent(new je("seal",{path:e.path},e)),e}};var Pe={concat:function(e,t){const{target:n,path:s,schema:r}=e,{enableValidation:i,mutatorEvents:o,source:a,validationEvents:c}=t,l=[].concat(...arguments);let u=n.length;const p=[];let h,d=[...Array.from(n)];e:for(let t of l){if(r&&i){const t=e.valueOf(),n=a||U(t),s=r.validateProperty(u,$subvalue,n,t);if(r&&c){let t,n;s.valid?(t="validProperty",n=["validProperty",u].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",u].join(":"));for(const r of[t,n])e.dispatchEvent(new Ee(r,s,e))}if(!s.valid){u++;continue e}}const n=s?[s,u].join("."):String(u);if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());let s=r?.target[0].type.value||null;const i=U(t);let o=new e.constructor(i,s,{path:n,parent:e});o.concat(t),p[u]=o}else p[u]=t;if(d=Array.prototype.concat.call(d,p[u]),o){const t=s?[s,u].join("."):String(u);o.concatElement&&e.dispatchEvent(new je("concatElement",{path:t,value:p[u],detail:{valueIndex:u,value:p[u]}},e)),o["concatElement:$index"]&&e.dispatchEvent(new je("concatElement",{path:t,value:p[u],detail:{valueIndex:u,value:p[u]}},e))}u++}return h=new e.constructor(d,r,e.options),o&&o.concat&&e.dispatchEvent(new je("concat",{path:s,detail:{values:h}},e)),h},copyWithin:function(e,t){const{target:n,path:s}=e,{enableValidation:r,validationEvents:i,mutatorEvents:o}=t,a=arguments[0]>=0?arguments[0]:n.length=arguments[0],c=arguments[1]>=0?arguments[1]:n.length+arguments[1],l=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],u=[];let p=c,h=a;for(;p<l;){const t=n[p];if(u.push(t),Array.prototype.copyWithin.call(n,h,p,p+1),e.retroReenableEvents(),o){const n=s?[s,p].join("."):String(p);if(o.copyWithinElement&&e.dispatchEvent(new je("copyWithinElement",{path:n,value:t,detail:{target:h,start:p,end:p+1,item:t}},e)),o["copyWithinElement:$index"]){const s=["copyWithinElement",p].join(":");e.dispatchEvent(new je(s,{path:n,value:t,detail:{target:h,start:p,end:p+1,item:t}},e))}}p++,h++}return o&&o.copyWithin&&e.dispatchEvent(new je("copyWithin",{path:s,detail:{target:a,start:c,end:l,items:u}},e)),e},fill:function(e,t,...n){const s=Object.assign({},t),{target:r,path:i,schema:o}=e,a=s.assignObject,c=s.assignArray||a,{enableValidation:l,lengthen:u,mutatorEvents:p,validationEvents:h}=s,d=[];let f,v;f="number"==typeof n[1]?n[1]>=0?n[1]:r.length+n[1]:0,v="number"==typeof n[2]?n[2]>=0?n[2]:r.length+n[2]:r.length,u&&r.length<v&&(r.length=v);let g=f;e:for(;g<r.length&&g<v;){if(o&&l){let t=o.validate(t,e.valueOf());if(h){let n,s;t.valid?(n="validProperty",s=["validProperty",g].join(":")):(n="nonvalidProperty",s=["nonvalidProperty",g].join(":"));for(const r of[n,s])e.dispatchEvent(new Ee(r,t,e))}if(!t.valid)continue e}const t=i?[i,g].join("."):String(g);let u,f=n[0];if(f&&"object"==typeof f){f instanceof e.constructor&&(f=f.valueOf());const n=o?.target[0].type.value||null,r=U(f),i=Object.assign({},s,{path:t,parent:e});u=new e.constructor(r,n,i)}if(Array.prototype.fill.call(r,u,g,g+1),e.retroReenableEvents(),"array"===u.type?["push","unshift"].includes(c)?u[c](...f):u[c](f):"object"===u.type&&u[a](f),d.push(u),p){const t=i?[i,g].join("."):String(g);if(p.fillElement&&e.dispatchEvent(new je("fillElement",{path:t,value:u,detail:{start:g,end:g+1,value:u}},e)),p["fillElement:$index"]){const n=["fillElement",g].join(":");e.dispatchEvent(new je(n,{path:t,detail:{start:g,end:g+1,value:u}},e))}}g++}return p&&p.fill&&e.dispatchEvent(new je("fill",{path:i,detail:{start:f,end:v,filled:d}},e)),e},pop:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e,i=Array.prototype.pop.call(s),o=s.length-1;if(e.retroReenableEvents(),n&&n.pop){const t=r?[r,o].join("."):String(o);e.dispatchEvent(new je("pop",{path:t,value:i,detail:{elementIndex:o,element:i}},e))}return i},push:function(e,t,...n){const s=Object.assign({},t),r="push",i=s.assignObject,{enableValidation:o,mutatorEvents:a,source:c,validationEvents:l}=s,{target:u,path:p,schema:h}=e,d=[];let f=0;for(let t of n){let n;if(h&&o){const n=e.valueOf(),s=c||U(n),r=h.validateProperty(f,t,s,n);if(l){let t,n;r.valid?(t="validProperty",n=["validProperty",f].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",f].join(":"));for(const s of[t,n])e.dispatchEvent(new Ee(s,r,e))}if(!r.valid)return u.length}const v=p?[p,f].join("."):String(f);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const o=h?.target[0].type.value||null,a=U(z(t)),c=Object.assign({},s,{path:v,parent:e});n=new e.constructor(a,o,c),Array.prototype.push.call(u,n),e.retroReenableEvents(),"array"===n.type?["push","unshift"].includes(r)?n[r](...t):n[r](t):"object"===n.type&&n[i](t)}else n=t,Array.prototype.push.call(u,n);if(d.push(n),a){const t=p?[p,f].join("."):String(f);if(a.pushElement&&e.dispatchEvent(new je("pushElement",{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e)),a["pushElement:$index"]){const n=["pushElement",f].join(":");e.dispatchEvent(new je(n,{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e))}}f++}return a&&a.push&&e.dispatchEvent(new je("push",{path:p,detail:{elements:d}},e)),u.length},reverse:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e;return Array.prototype.reverse.call(s,...arguments),e.retroReenableEvents(),n&&n.reverse&&e.dispatchEvent(new je("reverse",{path:r,detail:{reference:s}},e)),e},shift:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e,i=Array.prototype.shift.call(s),o=0;if(e.retroReenableEvents(),n&&n.shift){const t=r?[r,o].join("."):String(o);e.dispatchEvent(new je("shift",{path:t,value:i,detail:{elementIndex:o,element:i}},e))}return i},splice:function(e,t){const n=Object.assign({},t),s=n.assignObject,r=n.assignArray||s,{mutatorEvents:i,source:o}=n,{target:a,path:c,schema:l}=e,{enableValidation:u,validationEvents:p}=n,h=[...arguments],d=h[0]>=0?h[0]:a.length+h[0],f=h[1]<=0?0:void 0===h[1]||d+h[1]>=a.length?a.length-d:h[1],v=h.slice(2),g=v.length,y=[];let b=0;for(;b<f;){const t=Array.prototype.splice.call(a,d,1)[0];if(y.push(t),i){const n=c?[c,b].join("."):String(b);if(i.spliceDeleteElement&&e.dispatchEvent(new je("spliceDeleteElement",{path:n,value:t,detail:{index:d+b,deleteIndex:b,deleteItem:t}},e)),i["spliceDeleteElement:$index"]){const s=["spliceDeleteElement",b].join(":");e.dispatchEvent(new je(s,{path:n,value:t,detail:{index:d+b,deleteIndex:b,deleteItem:t}},e))}}b++}let m=0;e:for(;m<g;){let t=v[m];if(l&&u){const t=e.valueOf(),n=o||U(t),s=l.validateProperty(elementIndex,element,n,t);if(p){let t,n;s.valid?(t="validProperty",n=["validProperty",m].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",m].join(":"));for(const r of[t,n])e.dispatchEvent(new ValidatorEvent(r,s,e))}if(!s.valid){m++;continue e}}const h=c?[c,m].join("."):String(m);let f=d+m;if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());const i=l?.target[0].type.value||null,o=U(t),c=recursiveAssign({},n,{path:h,parent:e});t=new e.constructor(o,i,c),Array.prototype.splice.call(a,f,0,t),e.retroReenableEvents(),"array"===t.type?["push","unshift"].includes(r)?t[r](...$value):t[r]($value):"object"===t.type&&t[s]($value)}else Array.prototype.splice.call(a,f,0,t);if(i){const n=c?[c,m].join("."):String(m);if(i.spliceAddElement&&e.dispatchEvent(new je("spliceAddElement",{path:n,value:t,detail:{index:d+m,addIndex:m,addItem:t}},e)),i["spliceAddElement:$index"]){const s=["spliceAddElement",m].join(":");e.dispatchEvent(new je(s,{path:n,value:t,detail:{index:d+m,addIndex:m,addItem:t}},e))}}m++}return i&&i.splice&&e.dispatchEvent(new je("splice",{path:c,detail:{$start:d,deleted:y,added:v,length:a.length}},e)),y},unshift:function(e,t,...n){const s=Object.assign({},t),r=s.assignObject,{enableValidation:i,mutatorEvents:o,source:a,validationEvents:c}=s,{target:l,path:u,schema:p}=e,h=[];let d=0;for(let t of n){let n;if(p&&i){const n=e.valueOf(),s=a||U(n),r=p.validateProperty(d,t,s,n);if(c){let t,n;r.valid?(t="validProperty",n=["validProperty",d].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",d].join(":"));for(const s of[t,n])e.dispatchEvent(new ValidatorEvent(s,r,e))}if(!r.valid)return l.length}const f=u?[u,d].join("."):String(d);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const i=p?.target[0].type.value||null,o=U(z(t)),a=Object.assign({},s,{path:f,parent:e});n=new e.constructor(o,i,a),Array.prototype.unshift.call(l,n),e.retroReenableEvents(),"array"===n.type?n.unshift(...t):"object"===n.type&&n[r](t)}else n=t,Array.prototype.unshift.call(l,n);if(h.unshift(n),o){const t=u?[u,d].join("."):String(d);if(o.unshiftElement&&e.dispatchEvent(new je("unshiftElement",{path:t,value:h[d],detail:{elementsIndex:d,element:h[d]}},e)),o["unshiftElement:$index"]){const n=["unshiftElement",d].join(":");e.dispatchEvent(new je(n,{path:t,value:h[d],detail:{elementsIndex:d,element:h[d]}},e))}}d++}return o&&o.unshift&&e.dispatchEvent(new je("unshift",{path:u,detail:{elements:h}},e)),l.length}};var xe={get:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(2===n.length&&H(r,n[1]),s=function(e,t,n){const{target:s,path:r}=e,{mutatorEvents:i,pathkey:o,subpathError:a}=t;if(!0===o){const o=n.split(new RegExp(K)),c=o.shift();let l=s[c];if(o.length){if(!1===a&&void 0===l)return;return l.get(o.join("."),t)}if(i&&(i.getProperty&&e.dispatchEvent(new je("getProperty",{path:r,value:l,detail:{key:c,value:l}},e)),i["getProperty:$key"])){const t=["getProperty",c].join(":"),n=[r,c].join(".");e.dispatchEvent(new je(t,{path:n,detail:{value:l}},e))}return l}if(!1===o)return s[propertyKey]}(e,r,...n)):(1===n.length&&H(r,n[0]),s=function(e,t){const{path:n}=e,{mutatorEvents:s}=t;return s&&s.get&&e.dispatchEvent(new je("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},set:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(3===n.length&&H(r,n[2]),s=function(e,t,n,s){const r=Object.assign({},t),i="set",o=r.assignArray||"set",{target:a,path:c,schema:l}=e,{enableValidation:u,mutatorEvents:p,pathkey:h,recursive:d,subpathError:f,validationEvents:v,source:g}=r;if(!0===h){const t=n.split(new RegExp(K)),h=t.shift();let y;const b=z(s),m=c?[c,h].join("."):String(h);if(t.length){if(d&&void 0===a[h]){let t,n;t="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[h].type.value:void 0,n="array"===b?[]:"object"===b||isNaN(Number(h))?{}:[];const s=H({},r,{path:m,parent:e});y=new e.constructor(n,t,s)}else y=a[h];if(!1===f&&void 0===y)return;return"array"===y.type?["push","unshift"].includes(o)?y[o](...s):y[o](s):"object"===y.type&&y[i](t.join("."),s,r),y}if(l&&u){const t=e.valueOf(),n=g||U(t),r=l.validateProperty(h,s,n,t);if(v){let t,n;r.valid?(t="validProperty",n=["validProperty",h].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",h].join(":"));for(const s of[t,n])e.dispatchEvent(new Ee(s,r,e))}if(!r.valid)return}if(s&&"object"==typeof s){s instanceof e.constructor&&(s=s.valueOf());const t=z(s);let n,c;n="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[h].type.value:void 0,c="array"===t?[]:"object"===t||isNaN(Number(h))?{}:[];const u=H({},r,{path:m,parent:e});y=new e.constructor(c,n,u),a[h]=y,e.retroReenableEvents(),"array"===y.type?["push","unshift"].includes(o)?y[o](...s):y[o](s):"object"===y.type&&y[i](s)}else y=s,a[h]=y;const j=y.valueOf();if(p){const t=c?[c,h].join("."):String(h);if(p.setProperty&&e.dispatchEvent(new je("setProperty",{path:t,value:j,detail:{key:h,value:j}},e)),p["setProperty:$key"]){const n=["setProperty",h].join(":");e.dispatchEvent(new je(n,{path:t,value:j,detail:{value:j}},e))}}return y}if(!1===h){let t=n;if(s&&"object"==typeof s){s instanceof e.constructor&&(s=s.valueOf());const n=z(s);let u,p;"array"===l?.type&&(u=l.target[0].type.value),u="object"===l?.type?l.target[t].type.value:void 0,p="array"===n?[]:"object"===n||isNaN(Number(t))?{}:[];const h=H({},r,{path:c?[c,t].join("."):String(t),parent:e});propertyValue=new e.constructor(p,u,h),a[t]=propertyValue,e.retroReenableEvents(),"array"===propertyValue.type?["push","unshift"].includes(o)?propertyValue[o](...s):propertyValue[o](s):"object"===propertyValue.type&&propertyValue[i](s)}else propertyValue=s,a[t]=propertyValue;if(p){const n=c?[c,t].join("."):String(t);if(p.setProperty&&e.dispatchEvent(new je("setProperty",{path:n,value:_propertyValue,detail:{key:t,value:_propertyValue}},e)),p["setProperty:$key"]){const s=["setProperty",t].join(":");e.dispatchEvent(new je(s,{path:n,value:_propertyValue,detail:{value:_propertyValue}},e))}}return propertyValue}}(e,r,...n)):(2===n.length&&H(r,n[1]),s=function(e,t,n){const{path:s,schema:r}=e;let{enableValidation:i,mutatorEvents:o,required:a,validationEvents:c}=t;for(const[s,r]of Object.entries(n))e.set(s,r,Object.assign(t,{source:n}));return o&&o.set&&e.dispatchEvent(new je("set",{path:s,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},delete:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(2===n.length&&H(r,n[1]),s=function(e,t,n){const{target:s,path:r,schema:i}=e,{mutatorEvents:o,pathkey:a,subpathError:c,enableValidation:l,validationEvents:u}=t;if(!0!==a)if(!1!==a);else{const a=n,c=s[a];if(i&&l){const t=e.valueOf();delete t[a];const n=i.validate(a,t,e.valueOf());if(u){let t,s;n.valid?(t="validProperty",s=["validProperty",a].join(":")):(t="nonvalidProperty",s=["nonvalidProperty",a].join(":"));for(const r of[t,s])e.dispatchEvent(new Ee(r,n,e))}if(!n.valid)return}if(c instanceof e.constructor&&c.delete(t),delete s[a],o&&(o.deleteProperty&&e.dispatchEvent(new je("deleteProperty",{path:r,value:c,detail:{key:a,value:c}},e)),o["deleteProperty:$key"])){const t=["deleteProperty",a].join(":"),n=[r,a].join(".");e.dispatchEvent(new je(t,{path:n,value:c,detail:{value:c}},e))}}else{const a=n.split(new RegExp(K)),p=a.shift();let h=s[p];if(a.length){if(!1===c&&void 0===h)return;return h.delete(a.join("."),t)}if(i&&l){const t=e.valueOf();delete t[p];const n=i.validate(p,t,{},e.valueOf());if(u){let t,s;const i=r?[r,p].join("."):String(p);n.valid?(t="validProperty",s=["validProperty",p].join(":")):(t="nonvalidProperty",s=["nonvalidProperty",p].join(":"));for(const r of[t,s])e.dispatchEvent(new Ee(r,Object.assign(n,{path:i}),e))}if(!n.valid)return}if(h&&"object"==typeof h&&h.delete(t),delete s[p],o&&(o.deleteProperty&&e.dispatchEvent(new je("deleteProperty",{path:r,value:h,detail:{key:p,value:h}},e)),o["deleteProperty:$key"])){const t=["deleteProperty",p].join(":"),n=[r,p].join(".");e.dispatchEvent(new je(t,{path:n,value:h,detail:{value:h}},e))}}}(e,r,...n)):(1===n.length&&H(r,n[0]),s=function(e,t){const{target:n}=e;for(const[s,r]of Object.entries(n))e.delete(s,t);const{path:s}=e,{mutatorEvents:r}=t;return r&&r.delete&&e.dispatchEvent(new je("delete",{path:s,detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s}};const ke=Object.freeze({object:[{keys:["valueOf"],methodDescriptor:function(e,t){return{value:function(){return t.parse({type:"object"})}}}},{keys:["toString"],methodDescriptor:function(e,t){return{value:function(e={}){const n=void 0!==e.replacer?e.replacer:null,s=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:s})}}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],methodDescriptor:function(e,t){return{value:Object[e].bind(null,t.valueOf())}}},{keys:["propertyIsEnumerable","hasOwnProperty"],methodDescriptor:function(e,t){return{value:()=>t.parse({type:"object"})[e]}}},{type:"mutators",keys:Object.keys(we),methodDescriptor:function(e,t,n){return{value:we[e].bind(null,t,n)}}}],array:[{keys:["length"],methodDescriptor:function(e,t,n){return{get:()=>t.target.length,set(e){t.target.length=e}}}},{keys:["from","fromAsync","isArray","of"],methodDescriptor:function(e,t){return{value:Array[e]}}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],methodDescriptor:function(e,t){return{value:Array.prototype[e].bind(null,t)}}},{type:"mutators",keys:Object.keys(Pe),methodDescriptor:function(e,t,n){return{value:Pe[e].bind(null,t,n)}}}],map:[{type:"mutators",keys:Object.keys(xe),methodDescriptor:function(e,t,n){return{value:xe[e].bind(null,t,n)}}}]});const Se=Object.freeze(["push","unshift"]),$e=Object.freeze(["assign","defineProperties","set"]);function Ae(e,t,n){const{type:s}=e,{assignObject:r,assignArray:i}=n;return"array"===s&&Se.includes(i)?e[i](...t):"object"===s&&$e.includes(r)&&e[r](t),e}class Ce extends O{constructor(e={},t=null,n={}){super({propertyDirectory:{accessors:[(e,t)=>void 0===t?e.target:e.get(t)]}}),e instanceof Ce&&(e=e.valueOf());let s=null,r=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,i=n?n.split(".").pop():n;s&&s.unmount(i),s=t,r=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{options:{configurable:!0,get(){const e=(e=>H({autoload:!1,autosave:!1,localStorage:!1,path:null,parent:null,enableEvents:!1,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,assignObject:"set",assignArray:"set",methods:{map:{get:{mutatorEvents:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,mutatorEvents:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{mutatorEvents:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{mutatorEvents:{"concatElement:$index":!0,concatElement:!0,concat:!0}},copyWithin:{mutatorEvents:{"copyWithinElement:$index":!0,copyWithinElement:!0,copyWithin:!0}},fill:{lengthen:!0,mutatorEvents:{"fillElement:$index":!0,fillElement:!0,fill:!0}},pop:{mutatorEvents:{pop:!0}},push:{mutatorEvents:{"pushElement:$index":!0,pushElement:!0,push:!0}},reverse:{mutatorEvents:{reverse:!0}},shift:{mutatorEvents:{shift:!0}},splice:{mutatorEvents:{"spliceDeleteElement:$index":!0,spliceDeleteElement:!0,"spliceAddElement:$index":!0,spliceAddElement:!0,splice:!0}},unshift:{mutatorEvents:{"unshiftElement:$index":!0,unshiftElement:!0,unshift:!0}}},object:{assign:{sourceTree:!0,mutatorEvents:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,mutatorEvents:{defineProperties:!0}},defineProperty:{descriptorTree:!0,mutatorEvents:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,mutatorEvents:{freezeProperty:!0,freeze:!0}},seal:{recursive:!0,mutatorEvents:{sealProperty:!0,seal:!0}}}}},e))(n);if(e.events&&(this.addEvents(e.events),delete e.events),e.enableEvents){const t=typeof e.enableEvents;"boolean"===t?this.enableEvents():"object"===t&&this.enableEvents(e.enableEvents)}return Object.defineProperty(this,"options",{value:e}),e}},parent:{get:()=>s},path:{get:()=>r},key:{get:()=>r?r.pop():r},target:{configurable:!0,get(){const t=U(e);return Object.defineProperty(this,"target",{value:t}),t}},type:{configurable:!0,get(){const e=z(this.target);return Object.defineProperty(this,"type",{value:e}),e}},schema:{configurable:!0,get(){const e=z(t);let n;return["undefined","null"].includes(e)?n=null:t instanceof ye?n=t:["array","object"].includes(e)&&(n=new ye(t)),Object.defineProperty(this,"schema",{value:n}),n}}}),this.mount({parent:this.options.parent,path:this.options.path}),localStorage&&this.options.localStorage&&Object.defineProperties(this,{localStorage:{configurable:!0,get(){let e,t=[window.location.pathname];return this.path&&t.push(this.path),t=t.join(""),e=new te(t),Object.defineProperty(this,"localStorage",{value:e}),e}},save:{value:function(){return this.localStorage.set(this.valueOf())}},load:{value:function(){return this.localStorage.get()}},unload:{value:function(){return this.localStorage.remove()}}}),function(e){for(const[t,n]of Object.entries(ke))for(const s of n){const{keys:n,methodDescriptor:r,type:i}=s;for(const s of n)if("map"===t||"mutators"===i){const n=structuredClone(e.options.methods[t][s]),i=Object.assign({},e.options,n);delete i.mutatorEvents,i.mutatorEvents=n.mutatorEvents,Object.defineProperty(e,s,r(s,e,i))}else Object.defineProperty(e,s,r(s,e))}}(this),this.options.autoload?Ae(this,this.load()||e,this.options):Ae(this,e,this.options)}retroReenableEvents(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}parse(e={type:"object",replacer:null,space:0}){let t=U(this.type);for(const[e,n]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){let{enumerable:s,value:r,writable:i,configurable:o}=n;r instanceof Ce?Object.defineProperty(t,e,{enumerable:s,value:r.valueOf(),writable:i,configurable:o}):Object.defineProperty(t,e,{enumerable:s,value:r,writable:i,configurable:o})}let{type:n,replacer:s,space:r}=e;return"object"===n?t:"string"===n?JSON.stringify(t,s,r):void 0}}const Te={attribute:/\[\s*(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)\s*(?:(?<operator>\W?=)\s*(?<value>.+?)\s*(\s(?<caseSensitive>[iIsS]))?\s*)?\]/gu,id:/#(?<name>[-\w\P{ASCII}]+)/gu,class:/\.(?<name>[-\w\P{ASCII}]+)/gu,comma:/\s*,\s*/g,combinator:/\s*[\s>+~]\s*/g,"pseudo-element":/::(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>*)\))?/gu,"pseudo-class":/:(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>*)\))?/gu,universal:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?\*/gu,type:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)/gu},De=new Set(["combinator","comma"]),Re=new Set(["not","is","where","has","matches","-moz-any","-webkit-any","nth-child","nth-last-child"]),_e=/(?<index>[\dn+-]+)\s+of\s+(?<subtree>.+)/,Ie={"nth-child":_e,"nth-last-child":_e},qe=e=>{switch(e){case"pseudo-element":case"pseudo-class":return new RegExp(Te[e].source.replace("(?<argument>*)","(?<argument>.*)"),"gu");default:return Te[e]}};function Le(e,t){let n=0,s="";for(;t<e.length;t++){const r=e[t];switch(r){case"(":++n;break;case")":--n}if(s+=r,0===n)return s}return s}const Ve=/(['"])([^\\\n]+?)\1/g,Ne=/\\./g;function Be(e,t=Te){if(""===(e=e.trim()))return[];const n=[];e=(e=e.replace(Ne,((e,t)=>(n.push({value:e,offset:t}),"".repeat(e.length))))).replace(Ve,((e,t,s,r)=>(n.push({value:e,offset:r}),`${t}${"".repeat(s.length)}${t}`)));{let t,s=0;for(;(t=e.indexOf("(",s))>-1;){const r=Le(e,t);n.push({value:r,offset:t}),e=`${e.substring(0,t)}(${"".repeat(r.length-2)})${e.substring(t+r.length)}`,s=t+r.length}}const s=function(e,t=Te){if(!e)return[];const n=[e];for(const[e,s]of Object.entries(t))for(let t=0;t<n.length;t++){const r=n[t];if("string"!=typeof r)continue;s.lastIndex=0;const i=s.exec(r);if(!i)continue;const o=i.index-1,a=[],c=i[0],l=r.slice(0,o+1);l&&a.push(l),a.push({...i.groups,type:e,content:c});const u=r.slice(o+c.length+1);u&&a.push(u),n.splice(t,1,...a)}let s=0;for(const e of n)switch(typeof e){case"string":throw new Error(`Unexpected sequence ${e} found at index ${s}`);case"object":s+=e.content.length,e.pos=[s-e.content.length,s],De.has(e.type)&&(e.content=e.content.trim()||" ")}return n}(e,t),r=new Set;for(const e of n.reverse())for(const t of s){const{offset:n,value:s}=e;if(!(t.pos[0]<=n&&n+s.length<=t.pos[1]))continue;const{content:i}=t,o=n-t.pos[0];t.content=i.slice(0,o)+s+i.slice(o+s.length),t.content!==i&&r.add(t)}for(const e of r){const t=qe(e.type);if(!t)throw new Error(`Unknown token type: ${e.type}`);t.lastIndex=0;const n=t.exec(e.content);if(!n)throw new Error(`Unable to parse content for ${e.type}: ${e.content}`);Object.assign(e,n.groups)}return s}function Me(e,{list:t=!0}={}){if(t&&e.find((e=>"comma"===e.type))){const t=[],n=[];for(let s=0;s<e.length;s++)if("comma"===e[s].type){if(0===n.length)throw new Error("Incorrect comma at "+s);t.push(Me(n,{list:!1})),n.length=0}else n.push(e[s]);if(0===n.length)throw new Error("Trailing comma");return t.push(Me(n,{list:!1})),{type:"list",list:t}}for(let t=e.length-1;t>=0;t--){let n=e[t];if("combinator"===n.type){let s=e.slice(0,t),r=e.slice(t+1);return 0===s.length?{type:"relative",combinator:n.content,right:Me(r)}:{type:"complex",combinator:n.content,left:Me(s),right:Me(r)}}}switch(e.length){case 0:throw new Error("Could not build AST.");case 1:return e[0];default:return{type:"compound",list:[...e]}}}function*ze(e,t){switch(e.type){case"list":for(let t of e.list)yield*ze(t,e);break;case"complex":yield*ze(e.left,e),yield*ze(e.right,e);break;case"relative":yield*ze(e.right,e);break;case"compound":yield*e.list.map((t=>[t,e]));break;default:yield[e,t]}}function Ue(e,{recursive:t=!0,list:n=!0}={}){const s=Be(e);if(!s)return;const r=Me(s,{list:n});if(!t)return r;for(const[e]of ze(r)){if("pseudo-class"!==e.type||!e.argument)continue;if(!Re.has(e.name))continue;let t=e.argument;const n=Ie[e.name];if(n){const s=n.exec(t);if(!s)continue;Object.assign(e,s.groups),t=s.groups.subtree}t&&Object.assign(e,{subtree:Ue(t,{recursive:!0,list:!0})})}return r}function Ke(e){if(Array.isArray(e))return e.map((e=>e.content)).join("");switch(e.type){case"list":return e.list.map(Ke).join(",");case"relative":return e.combinator+Ke(e.right);case"complex":return Ke(e.left)+e.combinator+Ke(e.right);case"compound":return e.list.map(Ke).join("");default:return e.content}}class We{#P;#t;constructor(e){this.#P=e}get context(){return this.#P.context}get method(){return this.#P.method}get name(){return this.#P.name}get selector(){return this.#P.selector}get enable(){return this.#t}set enable(e){if(e!==this.#t){if(!0===e){const{context:e,name:t,method:n,selector:s}=this;Object.defineProperty(e.querySelectors,t,{configurable:!0,enumerable:!0,get:()=>e[n](s)})}else!1===e&&delete this.context.querySelectors[this.name];this.#t=e}}}const Fe=" ",He=">",Qe="~",Je="+";function Ge(e,t,n){let s=[],r=n,i=Be(r);":scope"!==i[0].content&&(r=[":scope",r].join(" "),i=Be(r)),i[0];const o=i[1],a=Ke(i.slice(2));Be(a);const c=Ue(a),l=Array.from(e.children);for(const[n,r]of Object.entries(l)){if("complex"===c.type){const{left:i,combinator:o,right:a}=c;let u;Ge(e,t,Ke(i)).length&&(o===Fe?(u=Ge(r,t,[":scope",Ke(a)].join(Fe)),s=s.concat(u)):o===He?(u=Ge(r,t,[":scope",Ke(a)].join(He)),s=s.concat(u)):o===Qe?(u=Ge({children:l.slice(n+1)},t,Ke(a)),s=s.concat(u)):o===Je&&(u=Ge({children:l.slice(n+1,n+2)},t,Ke(a)),s=s.concat(u)))}else if(r.matches(a)&&(s=s.concat(r)),o.content===Fe){const e=r[t](a);e instanceof NodeList?s=s.concat(...e):e instanceof Node&&(s=s.concat(e))}if("querySelector"===t&&s.length>0)return s.slice(0,1)}return s}class Xe extends C{#x;#k;#S;#$;#A;constructor(e={},t={}){super((e=>S({scope:"template",templates:{},querySelectors:{}},e))(e),(e=>Object.assign({events:!1,eventListeners:!1,enableEvents:!0,enableQuerySelectors:!0},e))(t)),Object.defineProperties(this,{_querySelectors:{enumerable:!1,writable:!1,configurable:!1,value:{}},querySelectors:{enumerable:!0,get(){return this._querySelectors}},qs:{enumerable:!0,get(){return this.querySelectors}}}),this.addQuerySelectors(this.settings.querySelectors);const{enableQuerySelectors:n,enableEvents:s}=this.options;n&&this.enableQuerySelectors(),s&&this.enableEvents()}get templates(){return void 0!==this.#x||(this.#x=this.settings.templates),this.#x}get scope(){return void 0!==this.#k||(this.#k=this.settings.scope),this.#k}get parentElement(){return void 0!==this.#S||(this.#S=this.settings.parentElement),this.#S}get#C(){return void 0!==this.#$||(this.#$=document.createElement("template")),this.#$}set#C(e){this.disableQuerySelectors(),this.#C.innerHTML=e,this.children=this.#C.content.children,this.parentElement.append(...this.children.values()),this.enableQuerySelectors(),this.retroReenableEvents()}get children(){return void 0!==this.#A||(this.#A=new Map),this.#A}set children(e){const t=this.children;t.forEach(((e,t)=>e?.parentElement.removeChild(e))),t.clear(),Array.from(e).forEach(((e,n)=>{t.set(n,e)}))}querySelector(e,t){return this.#T("querySelector",e,t)[0]||null}querySelectorAll(e,t){return this.#T("querySelectorAll",e,t)}#T(e,t){return Ge("template"===this.scope?{children:Array.from(this.children.values())}:{children:Array.from(this.parentElement.children)},e,t)}addQuerySelectors(e){if(void 0===e)return this;const{querySelectors:t}=this.settings;for(const[n,s]of Object.entries(e))for(const[e,r]of Object.entries(s))t[n]=t[n]||{},t[n][e]=new We({context:this,name:e,method:n,selector:r,enable:!1});return this}removeQuerySelectors(e){e=e||this.settings.querySelectors;for(const[t,n]of Object.entries(e))for(const[e,s]of Object.entries(n))void 0!==this.settings.querySelectors[t]&&delete this.settings.querySelectors[t][e];return this}enableQuerySelectors(e){e=e||this.settings.querySelectors;for(const t of Object.values(e))for(const e of Object.values(t))e.enable=!0;return this}disableQuerySelectors(e){e=e||this.settings.querySelectors;for(const t of Object.values(e))for(const e of Object.values(t))e.enable=!1;return this}render(e={},t="default"){return this.#C=this.templates[t](e),this}}const Ye={ok:(e,t)=>new CustomEvent(`${t}:ok`,{detail:{response:e}}),status:(e,t)=>new CustomEvent(`${t}:status`,{detail:{response:e}}),statusCode:(e,t)=>{const n=`${t}:status:${e.status}`;return new CustomEvent(n,{detail:{response:e}})},statusText:(e,t)=>new CustomEvent(`${t}:statusText`,{detail:{response:e}}),statusTextMessage:(e,t)=>{const n=`${t}:statusText:${e.statusText}`;return new CustomEvent(n,{detail:{response:e}})},abort:e=>new CustomEvent("abort",{detail:{abortController:e}})};class Ze extends EventTarget{#P={};#D;#R;#v;constructor(e={}){super(),this.#P=e,this.#D=this.#P.name,this.#R=this.#P.origin,this.#v=this.#P.path,this.addMethods(this.#P.methods)}addMethods(e){const t=this;for(const[n,s]of Object.entries(e)){const e=`${n}AbortSignal`;Object.defineProperties(t,{[e]:{enumerable:!1,writable:!0,value:void 0},[n]:{enumerable:!0,writable:!1,configurable:!1,value:async function(){const r=[...arguments];let i,o;0===r.length?(i="",o={}):1===r.length?"string"==typeof r[0]?(i=r[0],o={}):"object"==typeof r[0]&&(i="",o=r[0]):2===r.length&&("string"==typeof r[0]&&(i=r[0]),"object"==typeof r[1]&&(o=r[1]));const a=Object.assign({},s);let{urlSearchParams:c,headers:l,body:u,priority:p}=o,h=new URLSearchParams(c).toString();h.length>0&&(h="?".concat(h)),void 0!==l&&Object.assign(a.headers,l),void 0!==u&&(a.body=u),void 0!==p&&(a.priority=p);const d=String.prototype.concat(t.#R,this.#_(t.#v,i),h);return void 0!==t[e]&&(t[e].abort(),t.createEvent(t,"abort",t[e])),t[e]=new AbortController,a.signal=t[e].signal,await fetch(d,a).then((e=>(t.createEvent(t,"ok",e.clone(),n).createEvent(t,"status",e.clone(),n).createEvent(t,"statusCode",e.clone(),n).createEvent(t,"statusText",e.clone(),n).createEvent(t,"statusTextMessage",e.clone(),n),e))).catch((e=>{}))}}})}}#_(e,t){if(!1===e.includes(":"))return e;const n=e.split("/"),s=t.split("/");if(n.length!==s.length)return e;let r=[],i=0;for(;i<n.length;){let t=n[i];const o=s[i];if(t.includes(":"))t=s[i];else if(t!==o)return e;r.push(t),i++}return r.join("/")}removeMethods(e){for(const t of Object.values(e)){const e=`${t}AbortSignal`;!1===this[e].signal.aborted&&this[e].abort(),delete this[e],delete this[t]}}createEvent(e,t,n,s){const r=Ye[t](n,s);return e.dispatchEvent(r),this}}class et extends C{#I;#q;#L;#V;#N;#B={};constructor(e,t){super((e=>Object.assign({},e))(e),(e=>Object.assign({enableEvents:!0},e))(t));const{scheme:n,domain:s,port:r,routes:i}=e;this.#I=n,this.#q=s,this.#L=r,this.routes=i,!0===t.enableEvents&&this.enableEvents()}get#M(){return void 0===this.#V&&(this.#V=String.prototype.concat(this.#q,":",this.#L)),this.#V}get#R(){return void 0===this.#N&&(this.#N=String.prototype.concat(this.#I,"://",this.#M)),this.#N}get routes(){return this.#B}set routes(e){this.addRoutes(e)}addRoutes(e){const t=this.#B;for(let[n,s]of Object.entries(e))s.origin=this.#R,s.path=n,t[s.name]=new Ze(s);return this}removeRoutes(e){const t=this.#B;for(const n of e)delete t[n];return this}}var tt,nt={};var st=function(){if(tt)return nt;tt=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.TokenData=void 0,nt.parse=l,nt.compile=function(t,n={}){const{encode:s=encodeURIComponent,delimiter:r=e}=n,i=u((t instanceof c?t:l(t,n)).tokens,r,s);return function(e={}){const[t,...n]=i(e);if(n.length)throw new TypeError(`Missing parameters: ${n.join(", ")}`);return t}},nt.match=function(n,s={}){const{decode:r=decodeURIComponent,delimiter:i=e}=s,{regexp:o,keys:a}=p(n,s),c=a.map((e=>!1===r?t:"param"===e.type?r:e=>e.split(i).map(r)));return function(e){const t=o.exec(e);if(!t)return!1;const n=t[0],s=Object.create(null);for(let e=1;e<t.length;e++){if(void 0===t[e])continue;const n=a[e-1],r=c[e-1];s[n.name]=r(t[e])}return{path:n,params:s}}},nt.pathToRegexp=p,nt.stringify=function(e){return e.tokens.map((function e(t,r,i){if("text"===t.type)return t.value.replace(/[{}()\[\]+?!:*]/g,"\\$&");if("group"===t.type)return`{${t.tokens.map(e).join("")}}`;const o=function(e){const[t,...r]=e;return!!n.test(t)&&r.every((e=>s.test(e)))}(t.name)&&function(e){return"text"!==(null==e?void 0:e.type)||!s.test(e.value[0])}(i[r+1]),a=o?t.name:JSON.stringify(t.name);if("param"===t.type)return`:${a}`;if("wildcard"===t.type)return`*${a}`;throw new TypeError(`Unexpected token: ${t}`)})).join("")};const e="/",t=e=>e,n=/^[$_\p{ID_Start}]$/u,s=/^[$\u200c\u200d\p{ID_Continue}]$/u,r="https://git.new/pathToRegexpError",i={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function o(e){return e.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}class a{constructor(e){this.tokens=e}peek(){if(!this._peek){const e=this.tokens.next();this._peek=e.value}return this._peek}tryConsume(e){const t=this.peek();if(t.type===e)return this._peek=void 0,t.value}consume(e){const t=this.tryConsume(e);if(void 0!==t)return t;const{type:n,index:s}=this.peek();throw new TypeError(`Unexpected ${n} at ${s}, expected ${e}: ${r}`)}text(){let e,t="";for(;e=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)t+=e;return t}}class c{constructor(e){this.tokens=e}}function l(e,o={}){const{encodePath:l=t}=o,u=new a(function*(e){const t=[...e];let o=0;function a(){let e="";if(n.test(t[++o]))for(e+=t[o];s.test(t[++o]);)e+=t[o];else if('"'===t[o]){let n=o;for(;o<t.length;){if('"'===t[++o]){o++,n=0;break}e+="\\"===t[o]?t[++o]:t[o]}if(n)throw new TypeError(`Unterminated quote at ${n}: ${r}`)}if(!e)throw new TypeError(`Missing parameter name at ${o}: ${r}`);return e}for(;o<t.length;){const e=t[o],n=i[e];if(n)yield{type:n,index:o++,value:e};else if("\\"===e)yield{type:"ESCAPED",index:o++,value:t[o++]};else if(":"===e){const e=a();yield{type:"PARAM",index:o,value:e}}else if("*"===e){const e=a();yield{type:"WILDCARD",index:o,value:e}}else yield{type:"CHAR",index:o,value:t[o++]}}return{type:"END",index:o,value:""}}(e));const p=function e(t){const n=[];for(;;){const s=u.text();s&&n.push({type:"text",value:l(s)});const r=u.tryConsume("PARAM");if(r){n.push({type:"param",name:r});continue}const i=u.tryConsume("WILDCARD");if(i){n.push({type:"wildcard",name:i});continue}if(!u.tryConsume("{"))return u.consume(t),n;n.push({type:"group",tokens:e("}")})}}("END");return new c(p)}function u(e,n,s){const r=e.map((e=>function(e,n,s){if("text"===e.type)return()=>[e.value];if("group"===e.type){const t=u(e.tokens,n,s);return e=>{const[n,...s]=t(e);return s.length?[""]:[n]}}const r=s||t;if("wildcard"===e.type&&!1!==s)return t=>{const s=t[e.name];if(null==s)return["",e.name];if(!Array.isArray(s)||0===s.length)throw new TypeError(`Expected "${e.name}" to be a non-empty array`);return[s.map(((t,n)=>{if("string"!=typeof t)throw new TypeError(`Expected "${e.name}/${n}" to be a string`);return r(t)})).join(n)]};return t=>{const n=t[e.name];if(null==n)return["",e.name];if("string"!=typeof n)throw new TypeError(`Expected "${e.name}" to be a string`);return[r(n)]}}(e,n,s)));return e=>{const t=[""];for(const n of r){const[s,...r]=n(e);t[0]+=s,t.push(...r)}return t}}function p(t,n={}){const{delimiter:s=e,end:r=!0,sensitive:i=!1,trailing:a=!0}=n,u=[],p=[],f=i?"":"i",v=(Array.isArray(t)?t:[t]).map((e=>e instanceof c?e:l(e,n)));for(const{tokens:e}of v)for(const t of h(e,0,[])){const e=d(t,s,u);p.push(e)}let g=`^(?:${p.join("|")})`;a&&(g+=`(?:${o(s)}$)?`),g+=r?"$":`(?=${o(s)}|$)`;return{regexp:new RegExp(g,f),keys:u}}function*h(e,t,n){if(t===e.length)return yield n;const s=e[t];if("group"===s.type){const r=n.slice();for(const n of h(s.tokens,0,r))yield*h(e,t+1,n)}else n.push(s);yield*h(e,t+1,n)}function d(e,t,n){let s="",i="",a=!0;for(let c=0;c<e.length;c++){const l=e[c];if("text"!==l.type)if("param"!==l.type&&"wildcard"!==l.type);else{if(!a&&!i)throw new TypeError(`Missing text after "${l.name}": ${r}`);"param"===l.type?s+=`(${f(t,a?"":i)}+)`:s+="([\\s\\S]+)",n.push(l),i="",a=!1}else s+=o(l.value),i+=l.value,a||(a=l.value.includes(t))}return s}function f(e,t){return t.length<2?e.length<2?`[^${o(e+t)}]`:`(?:(?!${o(e)})[^${o(t)}])`:e.length<2?`(?:(?!${o(t)})[^${o(e)}])`:`(?:(?!${o(t)}|${o(e)})[\\s\\S])`}return nt.TokenData=c,nt}();class rt extends EventTarget{#z;#t;#U;#K;constructor(e={}){super(),this.#P=e}get#P(){return this.#z}set#P(e){this.#z=e;for(const[t,n]of Object.entries(e))Object.defineProperty(this,t,{value:n})}get pathname(){return this.#P.pathname}get enable(){return void 0!==this.#t||(void 0!==this.#P.enable?this.#t=this.#P.enable:this.#t=!0),this.#t}set enable(e){this.#t!==e&&(this.#t=e)}get active(){return void 0!==this.#U||void 0===this.#P.active&&(this.#U=!1),this.#U}set active(e){this.#U!==e&&(this.#U=e)}get match(){return void 0!==this.#K||(this.#K=st.match(this.pathname)),this.#K}}class it extends CustomEvent{#W;constructor(e,t){super(e,t),this.#W=t}get path(){return this.#W.path}get route(){return this.#W.route}get location(){return this.#W.location}}class ot extends C{#F;#H;#B;#Q;#J;#t;#G={windowLocationOrigin:new RegExp(`^${this.window.location.origin}`)};constructor(e,t){super((e=>Object.assign({routes:{}},e))(e),(e=>Object.assign({enableEvents:!0},e))(t)),!0===t.enableEvents&&this.enableEvents(),this.enable=!0}get base(){return this.settings.base}get window(){return void 0!==this.#F||(this.#F=window),this.#F}get hashpath(){return void 0!==this.#H||(this.#H=void 0!==this.settings.hashpath&&this.settings.hashpath),this.#H}get routes(){if(void 0!==this.#B)return this.#B;this.#B={};const e=Object.entries(this.settings.routes);for(const[t,n]of e)this.setRoute(t,n);return this.#B}get location(){return this.#Q}get route(){return this.#J}get enable(){return this.#t}set enable(e){if(this.#t===e)return;const t=this.#X.bind(this);!0===e?this.#F.addEventListener("popstate",t):!1===e&&this.#F.removeEventListener("popstate",t),this.#t=e}#X(){this.navigate()}navigate(e,t){if("string"==typeof e&&["assign","replace"].includes(t))return this.window?.location[t](e),this;let n,s;[this.window.origin,this.base].join(""),this.hashpath?(n=this.window.location.hash.slice(1),s=this.#Y(n)):(n=this.window.location.href.replace(new RegExp(`^${this.window.origin}`),"").replace(new RegExp(`^${this.base}`),""),s=this.#Y(n));const{route:r,location:i}=s,o={route:r,location:i,path:n},a=this.route;return a&&(a.active=!1),r&&r?.enable?(r.active=!0,i.state=this.window.history.state,i.base=this.base,i.pathname=this.window.location.pathname.replace(new RegExp(`^${this.base}`),""),i.hash=this.window.location.hash,i.search=this.window.location.search,delete i.path,this.#J=r,this.#Q=i,this.dispatchEvent(new it("route",o)),this.dispatchEvent(new it(`route:${r.name}`,o))):(this.#J=null,this.#Q=null,this.dispatchEvent(new it("nonroute",o))),this}enableRoute(e){const t=this.getRoute(e);return t.enable=!0,t}disableRoute(e){const t=this.getRoute(e);return t.enable=!1,t}setRoute(e,t){const n=S({pathname:t.pathname||e},t);return this.#B[e]=new rt(n),this.#B[e]}getRoute(e){return this.#B[e]}deleteRoute(e){return delete this.#B[e],this.#B[e]}#Y(e){const t=Object.entries(this.routes);let n=0,s=null,r=null;e:for(;n<t.length;){const[i,o]=t[n];if(r=o.match(e)||null,r){s=o;break e}n++}return{route:s,location:r}}}class at extends CustomEvent{#P;#Z;constructor(e,t,n){super(e,t),this.#P=t,this.#Z=n}get isBinary(){return this.#P.isBinary}get message(){return this.#P.message}get detail(){return this.#P.detail}}class ct extends EventTarget{#P;#ee;#te;constructor(e){super(),this.#P=e}get name(){return this.#P.name}get messages(){return void 0!==this.#ee||(void 0!==this.#P.messages?this.#ee=this.#P.messages:this.#ee={}),this.#ee}get message(){return void 0!==this.#te||(this.#te=this.#P.message),this.#te}}class lt extends C{#ne;#U=!1;#se;#re;#ie;constructor(e={},t={}){super((e=>Object.assign({active:!1},e))(e),(e=>Object.assign({events:!1,enableEvents:!0},e))(t)),this.#ie=this.#te.bind(this),Object.defineProperties(this,{webSocket:{enumerable:!0,get(){return void 0!==this.#ne||(this.#ne=new WebSocket(this.url),this.#ne.addEventListener("message",this.#ie)),this.#ne}}}),this.active=this.settings.active,!0===this.options.enableEvents&&this.enableEvents()}get active(){return this.#U}set active(e){this.#U!==e&&(!0===e?this.webSocket:!1===e&&(this.#ne=void 0),this.#U=e)}get path(){return this.settings.path}get url(){if(void 0!==this.#re)return this.#re;let e,{protocol:t,host:n,port:s}=this.settings;return e=t&&n&&s?[t,"//",n,":",s].join(""):window.location.url.origin,this.#re=new URL(this.path,e),this.#re}#te(e,t){for(const n of this.messageAdapters)try{const s=n.message(e,t),{type:r,detail:i}=s,o=new at(r,{detail:i,message:e,isBinary:t},this);this.webSocket.dispatchEvent(o)}catch(e){console.error(e)}}get messageAdapters(){if(void 0!==this.#se)return this.#se;const e=[];for(const t of this.settings.messageAdapters){let n;t instanceof ct||(n=new ct(t,this)),e.push(n)}return this.#se=e,this.#se}send(){this.webSocket.send(...arguments)}}function ut(e,t,n,s){const r=s,i=e,o=e?.path?[e.path,s.name,t].join("."):[s.name,t].join(".");if(n&&dt.includes(n.constructor))n.mount({path:o,parent:i});else if(Array.isArray(n)){const{Class:e}=r;if(e===Ce){let[t,s,a]=n;s=s||null,a=a||{},Object.assign(a,{definition:r,parent:i,path:o}),n=new e(t,s,a)}else if(dt.includes(e)){if(2===n.length){const[t,s]=n;Object.assign(s,{definition:r,parent:i,path:o}),n=new e(t,s)}if(1===n.length){const[t]=n;n=new e(t)}}}return n}function pt(e,t,n){}class ht extends C{static propertyClasses=[{name:"models",targetType:"Object",administer:"addModels",deadminister:"removeModels",instate:ut,deinstate:pt,Class:Ce},{name:"views",targetType:"Object",administer:"addViews",deadminister:"removeViews",instate:ut,deinstate:pt,Class:Xe},{name:"locationRouters",targetType:"Object",administer:"addLocationRouters",deadminister:"removeLocationRouters",instate:ut,deinstate:pt,Class:ot},{name:"fetchRouters",targetType:"Object",administer:"addFetchRouters",deadminister:"removeFetchRouters",instate:ut,deinstate:pt,Class:et},{name:"socketRouters",targetType:"Object",administer:"addSocketRouters",deadminister:"removeSocketRouters",instate:ut,deinstate:pt,Class:lt},{name:"controls",targetType:"Object",administer:"addControls",deadminister:"removeControls",instate:ut,deinstate:pt,Class:ht}];constructor(e={},t={}){super((e=>Object.assign({models:{},views:{},controls:{},fetchRouters:{},locationRouters:{}},e))(Object.assign({},e)),(e=>Object.assign({events:!1,enableEvents:!0},e))(Object.assign({propertyClasses:ht.propertyClasses},t)))}}const dt=[Ce,Xe,ht,ot,et,lt],ft={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null};Object.values(ft);const vt={object:Object,array:Array};Object.values(vt);const gt=Object.assign({},ft,vt);Object.values(gt);const yt={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null},bt=Object.keys(yt),mt=Object.values(yt),jt={object:Object,array:Array},Ot=Object.keys(jt),Et=Object.values(jt),wt=Object.assign({},yt,jt),Pt=Object.keys(wt),xt=Object.values(wt),kt=[yt.String,yt.Number,yt.Boolean,jt.Object,jt.Array];var St=Object.freeze({__proto__:null,ObjectKeys:Ot,ObjectValues:Et,Objects:jt,PrimitiveKeys:bt,PrimitiveValues:mt,Primitives:yt,TypeKeys:Pt,TypeMethods:kt,TypeValues:xt,Types:wt}),$t=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function At(e){let t;const n=$t(e);if("string"===n){const n=e.toLowerCase();"object"===n?t={}:"array"===n&&(t=[])}else"object"===n?t={}:"array"===n&&(t=[]);return t}function Ct(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=$t(e[t]),r=$t(s);e[t]="object"===n&&"object"===r?Ct(e[t],s):s}return e}class Tt extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}}const Dt={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function Rt(e="expand",t){const n=t||this,s=n.schema,r=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=At(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const r of s)t[n.key][r.type]={},r.validation?t[n.key][r.type]=this.report(e,r.validation):t[n.key][r.type]=r}return t}if("impand"===e){if(!1===n.valid)return!1;const t=At(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);let r;e:for(const t of s)if("type"===t.type){t.validation&&n.valid&&(r=this.report(e,t.validation));break e}r||(r=n.valid),t[n.key]=r}return t}}class _t extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:Dt},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=Rt.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}}const It={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class qt extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:It},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,s){const{definition:r,messages:i,type:o}=this;let a=new Tt({type:o,key:e,value:r.value,messages:Ct({},i,r.messages)});const c=r.validate(...arguments);return"object"==typeof c?(a.validation=c,a.pass=c.valid):a.pass=c,a}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}}const{ObjectKeys:Lt,TypeKeys:Vt}=St;export{ht as Control,C as Core,et as FetchRouter,ot as LocationRouter,ct as MessageAdapter,Ce as Model,ye as Schema,lt as SocketRouter,_t as Validation,qt as Validator,Tt as Verification,Xe as View};
//# sourceMappingURL=mvc-framework.min.js.map
