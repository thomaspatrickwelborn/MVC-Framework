var e={default:(e,t)=>void 0===t?e:e[t],get:(e,t)=>void 0===t?e:e.get(t)};function t(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[s,r]of Object.entries(e)){const e=s.trim().split(" ");let i,o,a;1===e.length?(i=t,o=e[0]):e.length>1&&(i=e[0],o=e[1]),Array.isArray(r)?(a=r[0],r[1]):a=r;const c={type:o,path:i,listener:a,enable:!1};n.push(c)}return n}const n={string:String,number:Number,boolean:Boolean,undefined:void 0,null:null},s=Object.keys(n),r=Object.values(n),i={object:Object,array:Array},o=Object.keys(i),a=Object.values(i),c=Object.assign({},n,i),l=Object.keys(c),u=Object.values(c),p=[n.String,n.Number,n.Boolean,i.Object,i.Array];var h=Object.freeze({__proto__:null,ObjectKeys:o,ObjectValues:a,Objects:i,PrimitiveKeys:s,PrimitiveValues:r,Primitives:n,TypeKeys:l,TypeMethods:p,TypeValues:u,Types:c}),d={quotationEscape:/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/};const f=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function g(e){return e.split(new RegExp(d.quotationEscape))}function v(e){const t=g(e);return t.pop(),t}function y(e){return g(e).pop()}function b(e){return g(e).shift()}function m(e){return Number(b(e))?"array":"object"}function j(e){let t;const n=f(e);return"object"===n?t={}:"array"===n?t=[]:"string"===n?"object"===e?.toLowerCase()?t={}:"array"===e?.toLowerCase()&&(t=[]):t=void 0,t}function O(e,t){const n=e.split(new RegExp(d.quotationEscape)),s=n.pop();let r=t;for(const e of n)r=r[e];return r[s]}function E(e,t){const{keypaths:n,key:s,typeofRoot:r}=function(e){return{subpaths:g(e),keypaths:v(e),key:y(e),root:b(e),typeofRoot:m(e)}}(e),i=j(r);let o=i;for(const e of n)Number(e)?o[e]=[]:o[e]={},o=o[e];return o[s]=t,i}const w={depth:0,maxDepth:10,accessors:[e.default]};function P(e,t){const n=[],s=Object.assign({},w,t);if(s.depth++,s.depth>s.maxDepth)return n;for(const t of s.accessors){const r=t.bind(e)(e);if(r)for(const[e,t]of Object.entries(r))if(s.values?s.values&&n.push([e,t]):n.push(e),"object"==typeof t&&null!==t&&t!==r){const r=P(t,s);if(s.values){if(s.values)for(const[t,s]of r){const r=[e,t].join(".");n.push([r,s])}}else for(const t of r){const s=[e,t].join(".");n.push(s)}}}return n}function x(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=f(e[t]),r=f(s);e[t]="object"===n&&"object"===r?x(e[t],s):s}return e}var k=Object.freeze({__proto__:null,accessors:e,expandEvents:t,expandTree:function e(t,n){const s=f(n),r=f(t);if(!["string","function"].includes(s)||!["array","object"].includes(r))return t;let i=j(t);for(const[r,o]of Object.entries(t))"string"===s?i[r]=E(n,o):"function"===s&&(i[r]=n(o)),i[r][n]&&"object"==typeof i[r][n]&&(i[r][n]=e(i[r][n],n));return i},impandTree:function e(t,n){const s=f(n),r=f(t);if(!["string","function"].includes(s)||!["array","object"].includes(r))return t;let i=j(t);for(const[r,o]of Object.entries(t))"string"===s?i[r]=O(n,o):"function"===s&&(i[r]=n(o)),i[r]&&"object"==typeof i[r]&&(i[r]=e(i[r],n));return i},propertyDirectory:P,recursiveAssign:x,recursiveAssignConcat:function e(t,...n){if(!t)return t;for(const s of n)if(s)for(const[n,r]of Object.entries(s)){const s=f(t[n]),i=f(r);t[n]="object"===s&&"object"===i?e(t[n],r):"array"===s&&"array"===i?t[n].concat(r):r}return t},recursiveFreeze:function e(t){for(const[n,s]of Object.entries(t))s&&"object"==typeof s&&e(s);return Object.freeze(t)},regularExpressions:d,typeOf:f,typedObjectLiteral:j,variables:h});function S(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var s=e.substr(0,t),r=e.substr(t+2);if(s.length>0&&r.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function A(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,s=0,r=0,i=-1,o=[""],a=[],c=0;c<e.length;c++){var l=e[c];if("\\"!==l){if("{"===l)if(n)s++;else if(c>i&&!s){t=e.substring(i+1,c);for(var u=0;u<o.length;u++)o[u]+=t;a=[],i=c,n=!0,s++}else s--;else if("}"===l)if(n)r++;else if(1===r){if(t=e.substring(i+1,c),a.length>0){var p=[];a.push(A(t));for(u=0;u<o.length;u++)for(var h=0;h<a.length;h++)for(var d=0;d<a[h].length;d++)p.push(o[u]+a[h][d]);o=p}else{t=S(t);for(u=0;u<o.length;u++)o[u]+=t}i=c,r--}else r--;else n||","!==l||r-s!==1||(t=e.substring(i+1,c),a.push(A(t)),i=c);!n||r!==s&&c!==e.length-1||(n=!1,c=i-1)}else c++}if(-1===i)return[e];var f="{"===e[i]?i:i+1;if(f<e.length){t=e.substr(f);for(u=0;u<o.length;u++)o[u]+=t}return o}function $(e,t){var n,s=!1!==t["!"],r=!1!==t["()"],i=!1;if(s){for(n=0;n<e.length&&"!"===e[n];n++){if(r&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function T(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function C(e,t,n){var s=void 0===t.separator||t.separator,r="",i="",o=".";!0===s?(r="/",i="[/\\\\]",o="[^/\\\\]"):o=s?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=T(e[n]);return t}(r=s)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var a=s?i+"+?":"",c=s?i+"*?":"",l=s?e.split(r):[e];return{source:e,segments:l,options:t,separator:s,separatorSplitter:r,separatorMatcher:i,optionalSeparator:c,requiredSeparator:a,wildcard:o,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:s&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function _(e,t,n,s){return{source:e,isFirst:n,isLast:s,end:e.length-1}}var R="(?!\\.)";function L(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=R+t),e.dotHandled=!0,e.result.match+=t),e.result}function D(e,t,n){var s=e.support,r=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(s.excludeDot||(r.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:L(r,i);if(s.globstar&&"**"===t.source)return L(r,"(?:"+((r.dotHandled?"":R)+e.wildcard+"*?"+i)+")*?");for(;++r.i<=t.end;){if(r.char=r.segment.source[r.i],r.nextChar=r.i<t.end?t.source[r.i+1]:"","\\"===r.char){if(r.i<r.segment.end){r.escapeChar=!0;continue}r.char=""}e=r.pattern,t=r.segment;var o=r.char,a=r.i;if(e.support.brackets&&!r.scanningForParens){if(a>r.openingBracket&&a<=r.closingBracket){r.escapeChar?L(r,T(o)):a===r.closingBracket?(L(r,"]"),r.openingBracket=t.source.length):"-"===o&&a===r.closingBracket-1?L(r,"\\-"):"!"===o&&a===r.openingBracket+1?L(r,"^"):L(r,"]"===o?"\\]":o),r.escapeChar=!1;continue}if(a>r.openingBracket){"]"===o&&!r.escapeChar&&a>r.openingBracket+1&&a>r.closingBracket?(r.closingBracket=a,r.i=r.openingBracket,e.separator?L(r,"(?!"+e.separatorMatcher+")[",!0):L(r,"[",!0)):a===t.end&&(L(r,"\\["),r.i=r.openingBracket,r.openingBracket=t.source.length,r.closingBracket=t.source.length),r.escapeChar=!1;continue}if("["===o&&!r.escapeChar&&a>r.closingBracket&&a<t.end){r.openingBracket=a,r.escapeChar=!1;continue}}if(r.pattern.support.extglobs){var c=r.extglobModifiers,l=(o=r.char,r.nextChar);a=r.i;if("("!==l||r.escapeChar||"@"!==o&&"?"!==o&&"*"!==o&&"+"!==o&&"!"!==o){if(")"!==o||r.escapeChar){if("|"===o&&r.closingParens&&!r.scanningForParens&&!r.escapeChar){L(r,"|");continue}}else if(r.scanningForParens)r.closingParens++;else if(c.length){var u=c.pop();if("!"===u&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");L(r,")"+(u="!"===u||"@"===u?"":u)),r.addToMatch=!0,r.addToUnmatch=!0,r.closingParens--;continue}}else if(r.scanningForParens)r.openingParens++;else if(a>r.parensHandledUntil&&!r.closingParens)r.parensHandledUntil=a,r.scanningForParens=!0,r.openingParens++;else{if(r.closingParens>=r.openingParens){"!"===o&&(r.addToMatch=!0,r.addToUnmatch=!1,L(r,r.pattern.wildcard+"*?",!0),r.addToMatch=!1,r.addToUnmatch=!0,r.result.useUnmatch=!0),c.push(o),L(r,"(?:",!0),r.openingParens--,r.i++;continue}r.openingParens--}if(r.scanningForParens){r.closingParens!==r.openingParens&&a!==r.segment.end||(r.scanningForParens=!1,r.i=r.parensHandledUntil-1),r.escapeChar=!1;continue}}s=(e=r.pattern).support;!r.escapeChar&&s.star&&"*"===r.char?r.i!==r.segment.end&&"*"===r.nextChar||L(r,e.wildcard+"*?",!0):!r.escapeChar&&s.qMark&&"?"===r.char?L(r,e.wildcard,!0):L(r,T(r.char)),r.escapeChar=!1}return L(r,i)}function q(e,t,n){for(var s=C(e,t,n),r={match:"",unmatch:"",useUnmatch:!1},i=s.segments,o=0;o<i.length;o++){D(s,_(i[o],0,0===o,o===i.length-1),r)}return r.useUnmatch?"(?!^"+r.unmatch+"$)"+r.match:r.match}function I(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function V(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],s=0;s<e.length;s++)for(var r=t(e[s]),i=0;i<r.length;i++)n.push(r[i]);return n}(e,A));for(var n=[],s=[],r="",i=0;i<e.length;i++){var o=$(e[i],t),a=q(o.pattern,t,!o.isNegated);o.isNegated?s.push(a):n.push(a)}return s.length&&(r="(?!(?:"+s.join("|")+")$)"),n.length>1?r+="(?:"+n.join("|")+")":1===n.length?r+=n[0]:r.length&&(r+=q("**",t,!0)),"^"+r+"$"}(e,t),s=new RegExp(n,t.flags),r=I.bind(null,s);return r.options=t,r.pattern=e,r.regexp=s,r}class N{#e;#t=!1;#n=[];#s=[];#r;#i;#o;constructor(e,t){if(!e||!t)return this;const n=((e={})=>{const t={enable:!1,assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,errorLog:!1,methods:{assign:{addEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:o}=r;return t.addEventListener(n,s,i||o)},on:function(e,t){const{type:n,listener:s}=e;return t.on(n,s)},once:function(e,t){const{type:n,listener:s}=e;return t.once(n,s)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:o}=r;return t.removeEventListener(n,s,i||o)},off:function(e,t){const{type:n,listener:s}=e;return t.off(n,s)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...s){return t.emit(n,...s)}}}};for(const[n,s]of Object.entries(e))switch(n){case"methods":t[n]=x(t[n],s);break;case"enableEvents":break;default:t[n]=s}return t})(e);Object.defineProperties(this,{settings:{value:n},path:{value:n.path},type:{value:n.type},assigned:{value:[]},deassigned:{value:[]},transsigned:{value:[]},listener:{configurable:!0,get(){let e;if("string"===f(n.listener)){let s=t;e:for(const e of n.listener.split(".")){if(void 0===s[e])break e;s=s[e]}"function"===f(s)&&(e=s)}else e=n.listener;return!0===n.bindListener&&(e=e.bind(this.#e)),Object.defineProperty(this,"listener",{value:e}),e}}}),this.#e=t,this.enable=this.settings.enable}get enable(){return this.#t}set enable(e){const t=this.#a,n=this.assigned,s=this.deassigned;n.length=0,s.length=0;for(const r of t){const{path:t,target:i,enable:o}=r;if(this.settings,o!==e)if(!0===e)try{this.#c(i),r.enable=e,n.push(r)}catch(e){this.settings.errorLog&&console.error(e)}else if(!1===e)try{this.#l(i),r.enable=e,s.push(r)}catch(e){this.settings.errorLog&&console.error(e)}}this.#t=e}get#u(){return this.settings.target}get#a(){const e=this.#s,t=[];if(this.#u)for(const n of[].concat(this.#u)){const s=e.find((e=>e?.path===this.path));void 0!==s?t.push(s):void 0===s&&ptargets.push({path:this.path,target:n,enable:!1})}else if("string"===f(this.path)){const n=[];if(this.path===this.#p){const e={path:this.path,target:this.#e,enable:!1};t.push(e)}else{if(this.settings.propertyDirectory){const e=this.#h,t=V(this.path,{separator:"."});for(const[s,r]of e){!0===t(s)&&n.push([s,r])}"*"===this.path.charAt(0)&&n.unshift(this.#p)}else n.push(this.path);for(const[s,r]of n){const n=e.find((e=>e.path===s));let i,o=r;void 0!==o&&(o===n?.target?i=n:"object"==typeof o&&(i={path:s,target:o,enable:!1})),void 0!==i&&t.push(i)}}}return this.#s=t,this.#s}get#p(){return this.settings.propertyDirectory.scopeKey}get#c(){return void 0!==this.#r||(this.#r=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#r}get#l(){return void 0!==this.#i||(this.#i=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#i}get#d(){return void 0!==this.#o||(this.#o=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#o}get#h(){if(!this.settings.propertyDirectory)return null;const e=Object.assign(this.settings.propertyDirectory,{values:!0});return P(this.#e,e)}emit(){const e=this.#a,t=this.transsigned,n=this.#n;t.length=0,n.length=0;for(const s of e){const{target:e}=s;try{this.#d(e,...arguments),t.push(s)}catch(e){n.push(s)}}return this}}class z extends EventTarget{static implement=function(n,s){if(!n||!s)return;const r=((t={})=>{const n={events:{},enableEvents:!1,propertyDirectory:{accessors:[e.default],scopeKey:":scope",maxDepth:10},propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents",emitEvents:"emitEvents"}};for(const[e,s]of Object.entries(t))switch(e){case"propertyDefinitions":case"propertyDirectory":n[e]=Object.assign(n[e],s);break;default:n[e]=s}return n})(s),i=[];return Object.defineProperties(n,{[r.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments[0])return i;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of i){let s;e:for(const[e,r]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===r:t[e]===r,!1===s)break e;s=n}!0===s&&e.push(t)}return e}},[r.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return n;let e=t(arguments[0],r.propertyDirectory.scopeKey),s=arguments[1]||!1;for(let t of e){const e={};for(const t of["assign","deassign","transsign","propertyDirectory","bindListener"]){const n=r[t];void 0!==n&&(e[t]=n)}x(e,t);const o=new N(e,n);s&&(o.enable=!0),i.push(o)}return n}},[r.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){const e=n[r.propertyDefinitions.getEvents](arguments[0]);if(0===e.length)return n;let t=i.length-1;for(;t>-1;){const n=i[t];e.includes(n)&&(n.enable=!1,i.splice(t,1)),t--}return n}},[r.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){const e=n[r.propertyDefinitions.getEvents](arguments[0]);if(0===e.length)return n;for(const t of e)t.enable=!0;return n}},[r.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){const e=n[r.propertyDefinitions.getEvents](arguments[0]);if(0===e.length)return n;for(const t of e)t.enable=!1;return n}},[r.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){const e=n[r.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!1,t.enable=!0;return n}},[r.propertyDefinitions.emitEvents]:{enumerable:!1,writable:!1,value:function(e,...t){const s=n[r.propertyDefinitions.getEvents](e);for(const e of s)e.emit(...t);return n}}}),r.events&&n[r.propertyDefinitions.addEvents](r.events),!0===r.enableEvents&&n[r.propertyDefinitions.enableEvents](),n};constructor(e={}){return super(),z.implement(this,e)}}const{regularExpressions:M}=k;function B(e){return e.split(new RegExp(M.quotationEscape))}function U(e){const t=B(e);return t.pop(),t}function K(e){return B(e).pop()}function F(e){return B(e).shift()}function W(e){return Number(F(e))?"array":"object"}function H(e){return{subpaths:B(e),keypaths:U(e),key:K(e),root:F(e),typeofRoot:W(e)}}var Q=Object.freeze({__proto__:null,key:K,keypaths:U,parse:H,root:F,subpaths:B,typeofRoot:W});const{regularExpressions:J,typedObjectLiteral:G}=k;function X(e,t){const{keypaths:n,key:s,typeofRoot:r}=H(e),i=G(r);let o=i;for(const e of n)Number(e)?o[e]=[]:o[e]={},o=o[e];return o[s]=t,i}var Y=Object.freeze({__proto__:null,get:function(e,t){const n=e.split(new RegExp(J.quotationEscape)),s=n.pop();let r=t;for(const e of n)r=r[e];return r[s]},set:X});const{typedObjectLiteral:Z,variables:ee}=k;const{isPropertyDefinition:te,recursiveAssign:ne,recursiveAssignConcat:se,regularExpressions:re,typedObjectLiteral:ie,typeOf:oe,variables:ae}=k;var ce=Object.freeze({__proto__:null,expandTree:function(e,t){const n=typeof e,s=typeof t;if(!["string","function"].includes(s))return;let r;if(e&&"object"===n)for(const[n,i]of Object.entries(e))"string"===s?r=X(t,i):"function"===s&&(r=t(i));else"string"===s?r=X(t,e):"function"===s&&(r=t(e));return r},isPropertyDefinition:te,keytree:function e(t){const n=[];for(const[s,r]of Object.entries(t))"object"==typeof r?n.push([s,e(r)]):n.push(s);return n},objectCount:function e(t){if(t&&"object"!=typeof t)return;let n=1;for(const[s,r]of Object.entries(t))"object"==typeof r&&(n+=e(r));return n},path:Q,pathkeytree:function e(t){const n=[];for(const[s,r]of Object.entries(t))if(n.push(s),"object"==typeof r){const t=e(r);for(const e of t){let t;t="object"==typeof e?[s,...e].join("."):[s,e].join("."),n.push(t)}}return n},recursiveAssign:ne,recursiveAssignConcat:se,regularExpressions:re,tree:Y,typedObjectLiteral:ie,variables:ae}),le=e=>Object.assign({},e),ue=e=>Object.assign({parent:null,path:null,enableEvents:!0,definition:null,propertyClasses:[]},e);const{typedObjectLiteral:pe}=k;class he extends z{static propertyClasses=[];constructor(e={},t={}){super(Object.assign({},t,{propertyDirectory:{accessors:[function(e,t){return void 0===t?e:e[t]},function(e,t){if(e instanceof Map==!0)return void 0===t?Object.fromEntries(e):e.get(t)},function(e,t){return void 0===t?e.target:e.target[t]}]}}));const n=[];let s=null,r=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,i=n?n.split(".").pop():n;s&&s.unmount(i),s=t,r=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{settings:{value:le(e)},options:{value:ue(t)},definition:{get:()=>definition},parent:{get:()=>s},path:{get:()=>r},key:{get:()=>r?r.pop():r},root:{get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},retroReenableEvents:{value:function(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}},addPropertyClasses:{value:function(){const e=this;let t=0===arguments.length?this.options.propertyClasses:[].concat(...arguments);e:for(const s of t){if(!s.targetType){n.push(s);continue e}const{name:t,administer:r,deadminister:i,instate:o,deinstate:a,targetType:c,definition:l}=s;Object.defineProperties(this,{[t]:{configurable:!0,enumerable:!0,writable:!0,value:pe(c)},[r]:{configurable:!0,enumerable:!1,writable:!1,value:function(n){e[t]||(e[t]=pe(c));for(const[r,i]of Object.entries(n))e[t][r]=o(e,r,i,s),e.retroReenableEvents();return e}},[i]:{configurable:!0,enumerable:!1,writable:!1,value:function(...n){let r;r=0===n.length?Object.keys(e[t]).reverse():[].concat(...n).reverse();for(const n of r)a(e,n,s),delete e[t][n],e.retroReenableEvents();return e}}}),n.push(s)}return this}},removePropertyClasses:{value:function(...e){let t;t=0===e.length?n.reduce(((e,t)=>(e.push($propertyClass.name),e)),[]):[].concat(...e);for(const e of t){const t=n.findIndex((t=>t.name===e)),{name:s,deadminister:r}=n.splice(t,1)[0];this[r](),delete this[s]}return this}}}),this.settings.defineProperties&&Object.defineProperties(this,this.settings.defineProperties),this.settings.assign&&Object.assign(this,this.settings.assign),this.options.propertyClasses&&this.addPropertyClasses(this.options.propertyClasses),this.mount({parent:this.options.parent,path:this.options.path}),(e=>{n.map((e=>e.name));for(const t of n){const{administer:n,name:s,targetType:r}=t;r&&(void 0!==e[s]&&(void 0!==r?this[n](this.settings[s]):void 0!==this.settings[s]&&(this[s]=this.settings[s])))}})(this.settings)}}let de=class extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}};const{typedObjectLiteral:fe}=k,ge={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function ve(e="expand",t){const n=t||this,s=n.schema,r=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=fe(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const r of s)t[n.key][r.type]={},r.validation?t[n.key][r.type]=this.report(e,r.validation):t[n.key][r.type]=r}return t}if("impand"===e){if(!1===n.valid)return!1;const t=fe(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);let r;e:for(const t of s)if("type"===t.type){t.validation&&n.valid&&(r=this.report(e,t.validation));break e}r||(r=n.valid),t[n.key]=r}return t}}let ye=class extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:ge},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=ve.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}};const{recursiveAssign:be}=k,me={true:e=>`${e.pass}`,false:e=>`${e.pass}`};let je=class extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:me},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,s){const{definition:r,messages:i,type:o}=this;let a=new de({type:o,key:e,value:r.value,messages:be({},i,r.messages)});const c=r.validate(...arguments);return"object"==typeof c?(a.validation=c,a.pass=c.valid):a.pass=c,a}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}};const{recursiveAssign:Oe,typedObjectLiteral:Ee}=k;class we extends je{constructor(e,t){super(Object.assign({},e,{type:"required",validate:(e,n,s,r)=>{const{requiredProperties:i,requiredPropertiesSize:o,type:a}=t,c=Object.assign({},i);let l,u=o;if(Object.assign(Ee(a),s,r),this.definition,o){if(Object.hasOwn(c,e)&&(delete c[e],u--),u){const e=new Ve(c,{path:t.path,parent:t.parent}),n=Object.assign({},r,s);l=e.validate(n).valid}}else l=!0;return l}}),t)}}const{typeOf:Pe,variables:xe}=k,{ObjectKeys:ke,TypeKeys:Se}=xe;class Ae extends je{constructor(e={},t){super(Object.assign({},e,{type:"type",validate:(e,t,n,s)=>{let r;const i=this.definition;let o=Pe(i.value);if(o="function"===o?Pe(i.value()):i.value instanceof Ve?i.value.type:Pe(i.value),Se.includes(o)){const e=Pe(t);if("undefined"===e)r=!1;else if("undefined"===o)r=!0;else if(i.value instanceof Ve){r=i.value.validate(t,n)}else r=o===e}else r=!1;return r}}),t)}}class $e extends je{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let s;if("number"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,o;i=void 0===e||t>=e.value,o=void 0===r||t<=r.value,s=!(!i||!o)}return s}}),t)}}class Te extends je{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let s;if("string"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,o;i=void 0===e||t.length>=e.value,o=void 0===r||t.length<=r.value,s=!(!i||!o)}return s}}),t)}}class Ce extends je{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let s;if(["string","number","boolean"].includes(typeof t)){s=n.value.includes(t)}else s=!1;return s}}),t)}}class _e extends je{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let s;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else s=!1;return!!s}}),t)}}const{recursiveAssign:Re}=k;var Le=(...e)=>Object.assign({required:!1,verificationType:"all",strict:!1,properties:{type:"type",value:"value"}},...e);const{typedObjectLiteral:De,typeOf:qe,variables:Ie}=k;class Ve extends EventTarget{constructor(e={},t={}){super(),Object.defineProperties(this,{options:{value:Le(t)},type:{value:qe(e)},parent:{configurable:!0,get(){const{options:e}=this,t=e.parent?e.parent:null;return Object.defineProperty(this,"parent",{value:t}),t}},root:{configurable:!0,get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},key:{configurable:!0,get(){const{path:e}=this,t=e?e.split(".").pop():null;return Object.defineProperty(this,"key",{value:t}),t}},path:{configurable:!0,get(){const{options:e}=this,t=e.path?String(e.path):null;return Object.defineProperty(this,"path",{value:t}),t}},required:{configurable:!0,get(){const e=this.options.required;return Object.defineProperty(this,"required",{value:e}),e}},requiredProperties:{configurable:!0,get(){const e=De(this.type);for(const[t,n]of Object.entries(this.target))!0===n.required?.value&&(e[t]=n);return Object.defineProperty(this,"requiredProperties",{value:Object.freeze(e)}),e}},requiredPropertiesSize:{configurable:!0,get(){const e=Object.keys(this.requiredProperties).length;return Object.defineProperty(this,"requiredPropertiesSize",{value:e}),e}},verificationType:{configurable:!0,get(){const e=this.options.verificationType;return Object.defineProperty(this,"verificationType",{value:e}),e}},target:{configurable:!0,get(){let t;const n=this.type;"array"===n?t=e.slice(0,1):"object"===n&&(t=e);const s=function(e,t){const n=De(e);if(Ne(e,t))return e;for(const[s,r]of Object.entries(e)){let e={};qe(r);const i=Ne(r,t);if(Ie.TypeValues.includes(r))Object.assign(e,{type:{value:r}});else if(Ie.TypeKeys.includes(r))Object.assign(e,{type:{value:Ie.Types[r]}});else if(i){if(i)for(const[n,i]of Object.entries(r)){const r=ze(i,t);if(r)r&&(e[n]=i);else{let r;if("type"===n)if(i&&"object"==typeof i){const e=t.path?[t.path,s].join("."):s;r=new Ve(i,Object.assign({},t.options,{parent:t,path:e}))}else r=i;else r=i;e[n]={type:n,value:r}}}}else{const n=t.path?[t.path,s].join("."):s;Object.assign(e,{type:{type:"type",value:new Ve(r,Object.assign({},t.options,{parent:t,path:n}))}})}e.validators=[],n[s]=e;const o=new Map;o.set("type",Object.assign({},{type:"type",validator:Ae,value:e.type.value})),o.set("required",Object.assign({},{type:"required",validator:we,value:e.required?.value||!1})),e.range?o.set("range",Object.assign({},e.range,{type:"range",validator:$e})):(e.min||e.max)&&o.set("range",Object.assign({},{type:"range",min:e.min,max:e.max,validator:$e})),e.length?o.set("length",Object.assign({},e.length,{type:"length",validator:Te})):(e.minLength||e.maxLength)&&o.set("length",Object.assign({},{type:"length",min:e.minLength,max:maxLength,validator:Te})),e.enum&&o.set("enum",Object.assign({},e.enum,{type:"enum",validator:Ce})),e.match&&o.set("match",Object.assign({},e.match,{type:"match",validator:_e})),delete e.min,delete e.max,delete e.minLength,delete e.maxLength;for(const[n,s]of o.entries()){const r=s.validator;e[n]=s,e.validators.push(new r(s,t))}}return n}(t,this);return Object.defineProperty(this,"target",{value:s}),s}},validate:{value:function(...e){let{$sourceName:t,$source:n,$target:s}=function(...e){let t,n,s;1===e.length?(t=null,n=e.shift(),s=null):2===e.length?["number","string"].includes(typeof e[0])?(t=e.shift(),n=e.shift(),s=null):e[0]&&"object"==typeof e[0]&&(t=null,n=e.shift(),s=e.shift()):3===e.length&&["number","string"].includes(typeof e[0])&&(t=e.shift(),n=e.shift(),s=e.shift());return{$sourceName:t,$source:n,$target:s}}(...e);s=s||De(n);const{target:r,path:i,required:o,type:a,verificationType:c}=this;let l=new ye({required:o,verificationType:c,definition:r,key:t,value:n},this);const u=Object.entries(n);let p=0;for(;p<u.length;){const[e,t]=u[p],r=this.validateProperty(e,t,n,s);!0===r.valid?l.advance.push(r):!1===r.valid?l.deadvance.push(r):void 0===r.valid&&l.unadvance.push(r),p++}return l.advance.length?l.valid=!0:l.deadvance.length?l.valid=!1:l.unadvance.length?l.valid=void 0:l.valid=!0,l}},validateProperty:{value:function(){const{$key:e,$value:t,$source:n,$target:s}=function(...e){let[t,n,s,r]=e;return{$key:t,$value:n,$source:s,$target:r}}(...arguments),{target:r,path:i,required:o,schema:a,type:c,verificationType:l}=this;let u;"array"===c?u=r[0]:"object"===c&&(u=r[e]);const p=new ye({required:o,verificationType:l,definition:u,key:e,value:t},this);if(void 0===u){const n=new de({type:null,definition:null,key:e,value:t},this);n.pass=!1,p.unadvance.push(n)}else e:for(const[r,i]of Object.entries(u.validators)){const r=i.validate(e,t,n,s);if(!0===r.pass?p.advance.push(r):!1===r.pass?p.deadvance.push(r):void 0===r.pass&&p.unadvance.push(r),"one"===this.verificationType&&p.deadvance.length)break e}return p.deadvance.length?p.valid=!1:p.advance.length?p.valid=!0:p.unadvance.length&&(p.valid=!1),p}}})}}function Ne(e,t){if(!e||e instanceof Ve)return!1;const n=t.options.properties.type;return Object.hasOwn(e,n)}function ze(e,t){if(!e)return!1;const n=t.options.properties.value;return Object.hasOwn(e,n)}const{recursiveAssign:Me}=k;class Be extends CustomEvent{constructor(e,t,n){super(e,t),Object.defineProperties(this,{model:{get:()=>n},key:{configurable:!0,get(){const e=this.path?this.path.split(".").pop():null;return Object.defineProperty(this,"key",{value:e}),e}},change:{configurable:!0,get(){const e=t.change;return Object.defineProperty(this,"change",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},path:{configurable:!0,get(){const e=t.path;return Object.defineProperty(this,"path",{value:e}),e}},detail:{configurable:!0,get(){const e=t.detail;return Object.defineProperty(this,"detail",{value:e}),e}}})}}class Ue{#f=!1;#g=!1;#v=!1;#y=!1;#b;#m;#j;#O;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#m}set preter(e){if(!0===this.#g)return this.#m;this.#m=e?.valueOf(),this.#g=!0}get anter(){return this.#j}set anter(e){if(!0===this.#v)return this.#j;this.#j=e?.valueOf(),this.#v=!0}get conter(){if(!0===this.#y||[this.#g,this.#v].includes(!1))return this.#O;const e=JSON.stringify(this.preter);let t;return t=JSON.stringify(this.anter)!==e,this.#O=t,this.#y=!0,this.#O}}let Ke=class extends CustomEvent{constructor(e,t,n){super(e),Object.defineProperties(this,{key:{configurable:!0,get(){const e=t.key;return Object.defineProperty(this,"key",{value:e}),e}},path:{configurable:!0,get(){const e=n.path?[n.path,t.key].join("."):t.key;return Object.defineProperty(this,"path",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},valid:{configurable:!0,get(){const e=t.valid;return Object.defineProperty(this,"valid",{value:e}),e}}})}};const{recursiveAssign:Fe,typedObjectLiteral:We}=k;const{typedObjectLiteral:He}=k;const{impandTree:Qe,recursiveAssign:Je,typedObjectLiteral:Ge}=k;var Xe={assign:function(e,t,...n){const s=Object.assign({},t),r=s.assignArray||"assign",{path:i,schema:o,source:a,target:c}=e,{enableValidation:l,mutatorEvents:u,required:p,sourceTree:h,validationEvents:d}=s,f=[],g=new Ue({preter:e});for(let t of n){let n;const a=new Ue({preter:e});let p;Array.isArray(t)?n=[]:t&&"object"==typeof t&&(n={}),l&&o&&(p=o.validate(t,e.valueOf()),p.report());e:for(let[a,p]of Object.entries(t)){const f=new Ue({preter:c[a]}),g=new Ue({preter:c[a]});if(o&&l){const n=e.valueOf(),s=t,r=o.validateProperty(a,p,s,n);if(d){let t,n;r.valid?(t="validProperty",n=["validProperty",a].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",a].join(":"));for(const s of[t,n])e.dispatchEvent(new Ke(s,r,e))}if(!r.valid)continue e}let v;if(p&&"object"==typeof p){let t;p instanceof e.constructor&&(v=p.valueOf()),t="array"===o?.type?o.target[0].type.value:"object"===o?.type?o.target[a].type.value:null;const l=i?[i,a].join("."):String(a);if(!1===h){const r=Fe({},s,{path:l,parent:e});v=new e.constructor(p,t,r);const i={[a]:v};Object.assign(c,i),Object.assign(n,i)}else{if(c[a]instanceof e.constructor)v=c[a];else{const n=We(p),r=Fe({},s,{path:l,parent:e});v=new e.constructor(n,t,r)}const i={[a]:v};Object.assign(c,i),Object.assign(n,i),e.retroReenableEvents(),"array"===v.type?["push","unshift"].includes(r)?v[r](...p):v[r](p):"object"===v.type&&v.assign(p)}}else{v=p;const e={[a]:v};Object.assign(c,e),Object.assign(n,e)}if(u){const t=i?[i,a].join("."):String(a);if(u["assignSourceProperty:$key"]){const s=["assignSourceProperty",a].join(":");g.anter=c[a],e.dispatchEvent(new Be(s,{path:t,value:v,change:g,detail:{source:n}},e))}u.assignSourceProperty&&(f.anter=c[a],e.dispatchEvent(new Be("assignSourceProperty",{path:t,value:v,change:f,detail:{source:n}},e)))}}f.push(n),u&&u.assignSource&&(a.anter=e,e.dispatchEvent(new Be("assignSource",{path:i,change:a,detail:{source:n}},e)))}return u&&u.assign&&(g.anter=e,e.dispatchEvent(new Be("assign",{path:i,change:g,detail:{sources:f}},e))),e},defineProperties:function(e,t,n){const{path:s,schema:r}=e;let{enableValidation:i,mutatorEvents:o,required:a,validation:c,validationEvents:l,validationReport:u}=t;const p=Object.entries(n),h=new Ue({preter:e});for(const[n,s]of p)e.defineProperty(n,s,Object.assign({},t,{validation:c,validationReport:u}));return o&&o.defineProperties&&(h.anter=e,e.dispatchEvent(new Be("defineProperties",{path:s,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,s){const r=Object.assign({},t),i=r.assignArray||"defineProperties",{descriptorTree:o,enableValidation:a,mutatorEvents:c,validation:l,validationEvents:u,validationReport:p}=r,{target:h,path:d,schema:f}=e,g=s.value,v=(Object.getOwnPropertyDescriptor(h,n)||{}).value,y=new Ue({preter:v}),b=new Ue({preter:v}),m=v instanceof e.constructor;if(f&&a){const t=f.validateProperty(n,Qe(g,"value")||g,{},e.valueOf());if(u){let s,r;t.valid?(s="validProperty",r=["validProperty",n].join(":")):(s="nonvalidProperty",r=["nonvalidProperty",n].join(":"));for(const n of[s,r])e.dispatchEvent(new Ke(n,t,e))}if(!t.valid)return e}if(g&&"object"==typeof g){const t=d?[d,n].join("."):String(n);if(m)!0===o?v.defineProperties(s):Object.defineProperty(h,n,s);else{let a;f&&(a="array"===f.type?f.target[0].type.value:"object"===f.type?f.target[n].type.value:void 0);let c=Ge(g);const l=Je({},r,{path:t,parent:e}),u=new e.constructor(c,a,l);!0===o?(h[n]=u,e.retroReenableEvents(),"array"===u.type?["push","unshift"].includes(i)?u[i](...g):u[i](g):"object"===u.type&&u.defineProperties(g)):!1===o&&Object.defineProperty(h,n,s)}}else Object.defineProperty(h,n,s);if(c){const t=d?[d,n].join("."):String(n);if(c["defineProperty:$key"]){b.anter=h[n];const r=["defineProperty",n].join(":");e.dispatchEvent(new Be(r,{path:t,value:g,change:b,detail:{prop:n,descriptor:s}},e))}c.defineProperty&&(y.anter=h[n],e.dispatchEvent(new Be("defineProperty",{path:t,value:g,change:y,detail:{prop:n,descriptor:s}},e)))}return e},freeze:function(e,t){const{recursive:n,mutatorEvents:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof e.constructor&&(n.freeze(),s&&s.freezeProperty&&e.dispatchEvent(new Be("freezeProperty",{path:n.path},e)));return Object.freeze(r),s&&s.freeze&&e.dispatchEvent(new Be("freeze",{path:e.path},e)),e},seal:function(e,t){const{recursive:n,mutatorEvents:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof e.constructor&&(n.seal(),s&&s.sealProperty&&e.dispatchEvent(new Be("sealProperty",{path:n.path},e)));return Object.seal(r),s&&s.seal&&e.dispatchEvent(new Be("seal",{path:e.path},e)),e}};const{typedObjectLiteral:Ye}=k;const{typedObjectLiteral:Ze}=k;const{recursiveAssign:et,typedObjectLiteral:tt,typeOf:nt}=k;const{typedObjectLiteral:st}=k;const{recursiveAssign:rt,typedObjectLiteral:it,typeOf:ot}=k;var at={concat:function(e,t){const{target:n,path:s,schema:r}=e,{enableValidation:i,mutatorEvents:o,source:a,validationEvents:c}=t,l=[].concat(...arguments);let u=n.length;const p=[];let h,d=[...Array.from(n)];e:for(let t of l){if(r&&i){const t=e.valueOf(),n=a||Ye(t),s=r.validateProperty(u,$subvalue,n,t);if(r&&c){let t,n;s.valid?(t="validProperty",n=["validProperty",u].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",u].join(":"));for(const r of[t,n])e.dispatchEvent(new Ke(r,s,e))}if(!s.valid){u++;continue e}}const n=s?[s,u].join("."):String(u);if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());let s=r?.target[0].type.value||null;const i=Ye(t);let o=new e.constructor(i,s,{path:n,parent:e});o.concat(t),p[u]=o}else p[u]=t;if(d=Array.prototype.concat.call(d,p[u]),o){const t=s?[s,u].join("."):String(u);o.concatElement&&e.dispatchEvent(new Be("concatElement",{path:t,value:p[u],detail:{valueIndex:u,value:p[u]}},e)),o["concatElement:$index"]&&e.dispatchEvent(new Be("concatElement",{path:t,value:p[u],detail:{valueIndex:u,value:p[u]}},e))}u++}return h=new e.constructor(d,r,e.options),o&&o.concat&&e.dispatchEvent(new Be("concat",{path:s,detail:{values:h}},e)),h},copyWithin:function(e,t){const{target:n,path:s}=e,{enableValidation:r,validationEvents:i,mutatorEvents:o}=t,a=arguments[0]>=0?arguments[0]:n.length=arguments[0],c=arguments[1]>=0?arguments[1]:n.length+arguments[1],l=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],u=[];let p=c,h=a;for(;p<l;){const t=n[p];if(u.push(t),Array.prototype.copyWithin.call(n,h,p,p+1),e.retroReenableEvents(),o){const n=s?[s,p].join("."):String(p);if(o.copyWithinElement&&e.dispatchEvent(new Be("copyWithinElement",{path:n,value:t,detail:{target:h,start:p,end:p+1,item:t}},e)),o["copyWithinElement:$index"]){const s=["copyWithinElement",p].join(":");e.dispatchEvent(new Be(s,{path:n,value:t,detail:{target:h,start:p,end:p+1,item:t}},e))}}p++,h++}return o&&o.copyWithin&&e.dispatchEvent(new Be("copyWithin",{path:s,detail:{target:a,start:c,end:l,items:u}},e)),e},fill:function(e,t,...n){const s=Object.assign({},t),{target:r,path:i,schema:o}=e,a=s.assignObject,c=s.assignArray||a,{enableValidation:l,lengthen:u,mutatorEvents:p,validationEvents:h}=s,d=[];let f,g;f="number"==typeof n[1]?n[1]>=0?n[1]:r.length+n[1]:0,g="number"==typeof n[2]?n[2]>=0?n[2]:r.length+n[2]:r.length,u&&r.length<g&&(r.length=g);let v=f;e:for(;v<r.length&&v<g;){if(o&&l){let t=o.validate(t,e.valueOf());if(h){let n,s;t.valid?(n="validProperty",s=["validProperty",v].join(":")):(n="nonvalidProperty",s=["nonvalidProperty",v].join(":"));for(const r of[n,s])e.dispatchEvent(new Ke(r,t,e))}if(!t.valid)continue e}const t=i?[i,v].join("."):String(v);let u,f=n[0];if(f&&"object"==typeof f){f instanceof e.constructor&&(f=f.valueOf());const n=o?.target[0].type.value||null,r=Ze(f),i=Object.assign({},s,{path:t,parent:e});u=new e.constructor(r,n,i)}if(Array.prototype.fill.call(r,u,v,v+1),e.retroReenableEvents(),"array"===u.type?["push","unshift"].includes(c)?u[c](...f):u[c](f):"object"===u.type&&u[a](f),d.push(u),p){const t=i?[i,v].join("."):String(v);if(p.fillElement&&e.dispatchEvent(new Be("fillElement",{path:t,value:u,detail:{start:v,end:v+1,value:u}},e)),p["fillElement:$index"]){const n=["fillElement",v].join(":");e.dispatchEvent(new Be(n,{path:t,detail:{start:v,end:v+1,value:u}},e))}}v++}return p&&p.fill&&e.dispatchEvent(new Be("fill",{path:i,detail:{start:f,end:g,filled:d}},e)),e},pop:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e,i=Array.prototype.pop.call(s),o=s.length-1;if(e.retroReenableEvents(),n&&n.pop){const t=r?[r,o].join("."):String(o);e.dispatchEvent(new Be("pop",{path:t,value:i,detail:{elementIndex:o,element:i}},e))}return i},push:function(e,t,...n){const s=Object.assign({},t),r="push",i=s.assignObject,{enableValidation:o,mutatorEvents:a,source:c,validationEvents:l}=s,{target:u,path:p,schema:h}=e,d=[];let f=0;for(let t of n){let n;if(h&&o){const n=e.valueOf(),s=c||tt(n),r=h.validateProperty(f,t,s,n);if(l){let t,n;r.valid?(t="validProperty",n=["validProperty",f].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",f].join(":"));for(const s of[t,n])e.dispatchEvent(new Ke(s,r,e))}if(!r.valid)return u.length}const g=p?[p,f].join("."):String(f);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const o=h?.target[0].type.value||null,a=tt(nt(t)),c=Object.assign({},s,{path:g,parent:e});n=new e.constructor(a,o,c),Array.prototype.push.call(u,n),e.retroReenableEvents(),"array"===n.type?["push","unshift"].includes(r)?n[r](...t):n[r](t):"object"===n.type&&n[i](t)}else n=t,Array.prototype.push.call(u,n);if(d.push(n),a){const t=p?[p,f].join("."):String(f);if(a.pushElement&&e.dispatchEvent(new Be("pushElement",{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e)),a["pushElement:$index"]){const n=["pushElement",f].join(":");e.dispatchEvent(new Be(n,{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e))}}f++}return a&&a.push&&e.dispatchEvent(new Be("push",{path:p,detail:{elements:d}},e)),u.length},reverse:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e;return Array.prototype.reverse.call(s,...arguments),e.retroReenableEvents(),n&&n.reverse&&e.dispatchEvent(new Be("reverse",{path:r,detail:{reference:s}},e)),e},shift:function(e,t){const{mutatorEvents:n}=t,{target:s,path:r}=e,i=Array.prototype.shift.call(s),o=0;if(e.retroReenableEvents(),n&&n.shift){const t=r?[r,o].join("."):String(o);e.dispatchEvent(new Be("shift",{path:t,value:i,detail:{elementIndex:o,element:i}},e))}return i},splice:function(e,t){const n=Object.assign({},t),s=n.assignObject,r=n.assignArray||s,{mutatorEvents:i,source:o}=n,{target:a,path:c,schema:l}=e,{enableValidation:u,validationEvents:p}=n,h=[...arguments],d=h[0]>=0?h[0]:a.length+h[0],f=h[1]<=0?0:void 0===h[1]||d+h[1]>=a.length?a.length-d:h[1],g=h.slice(2),v=g.length,y=[];let b=0;for(;b<f;){const t=Array.prototype.splice.call(a,d,1)[0];if(y.push(t),i){const n=c?[c,b].join("."):String(b);if(i.spliceDeleteElement&&e.dispatchEvent(new Be("spliceDeleteElement",{path:n,value:t,detail:{index:d+b,deleteIndex:b,deleteItem:t}},e)),i["spliceDeleteElement:$index"]){const s=["spliceDeleteElement",b].join(":");e.dispatchEvent(new Be(s,{path:n,value:t,detail:{index:d+b,deleteIndex:b,deleteItem:t}},e))}}b++}let m=0;e:for(;m<v;){let t=g[m];if(l&&u){const t=e.valueOf(),n=o||st(t),s=l.validateProperty(elementIndex,element,n,t);if(p){let t,n;s.valid?(t="validProperty",n=["validProperty",m].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",m].join(":"));for(const r of[t,n])e.dispatchEvent(new ValidatorEvent(r,s,e))}if(!s.valid){m++;continue e}}const h=c?[c,m].join("."):String(m);let f=d+m;if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());const i=l?.target[0].type.value||null,o=st(t),c=recursiveAssign({},n,{path:h,parent:e});t=new e.constructor(o,i,c),Array.prototype.splice.call(a,f,0,t),e.retroReenableEvents(),"array"===t.type?["push","unshift"].includes(r)?t[r](...$value):t[r]($value):"object"===t.type&&t[s]($value)}else Array.prototype.splice.call(a,f,0,t);if(i){const n=c?[c,m].join("."):String(m);if(i.spliceAddElement&&e.dispatchEvent(new Be("spliceAddElement",{path:n,value:t,detail:{index:d+m,addIndex:m,addItem:t}},e)),i["spliceAddElement:$index"]){const s=["spliceAddElement",m].join(":");e.dispatchEvent(new Be(s,{path:n,value:t,detail:{index:d+m,addIndex:m,addItem:t}},e))}}m++}return i&&i.splice&&e.dispatchEvent(new Be("splice",{path:c,detail:{$start:d,deleted:y,added:g,length:a.length}},e)),y},unshift:function(e,t,...n){const s=Object.assign({},t),r=s.assignObject,{enableValidation:i,mutatorEvents:o,source:a,validationEvents:c}=s,{target:l,path:u,schema:p}=e,h=[];let d=0;for(let t of n){let n;if(p&&i){const n=e.valueOf(),s=a||it(n),r=p.validateProperty(d,t,s,n);if(c){let t,n;r.valid?(t="validProperty",n=["validProperty",d].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",d].join(":"));for(const s of[t,n])e.dispatchEvent(new ValidatorEvent(s,r,e))}if(!r.valid)return l.length}const f=u?[u,d].join("."):String(d);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const i=p?.target[0].type.value||null,o=it(ot(t)),a=Object.assign({},s,{path:f,parent:e});n=new e.constructor(o,i,a),Array.prototype.unshift.call(l,n),e.retroReenableEvents(),"array"===n.type?n.unshift(...t):"object"===n.type&&n[r](t)}else n=t,Array.prototype.unshift.call(l,n);if(h.unshift(n),o){const t=u?[u,d].join("."):String(d);if(o.unshiftElement&&e.dispatchEvent(new Be("unshiftElement",{path:t,value:h[d],detail:{elementsIndex:d,element:h[d]}},e)),o["unshiftElement:$index"]){const n=["unshiftElement",d].join(":");e.dispatchEvent(new Be(n,{path:t,value:h[d],detail:{elementsIndex:d,element:h[d]}},e))}}d++}return o&&o.unshift&&e.dispatchEvent(new Be("unshift",{path:u,detail:{elements:h}},e)),l.length}};const{regularExpressions:ct}=k;const{recursiveAssign:lt}=k;const{recursiveAssign:ut,regularExpressions:pt,typedObjectLiteral:ht,typeOf:dt}=k;const{recursiveAssign:ft}=k;const{regularExpressions:gt}=k;const{recursiveAssign:vt}=k;var yt={get:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(2===n.length&&lt(r,n[1]),s=function(e,t,n){const{target:s,path:r}=e,{mutatorEvents:i,pathkey:o,subpathError:a}=t;if(!0===o){const o=n.split(new RegExp(ct.quotationEscape)),c=o.shift();let l=s[c];if(o.length){if(!1===a&&void 0===l)return;return l.get(o.join("."),t)}if(i&&(i.getProperty&&e.dispatchEvent(new Be("getProperty",{path:r,value:l,detail:{key:c,value:l}},e)),i["getProperty:$key"])){const t=["getProperty",c].join(":"),n=[r,c].join(".");e.dispatchEvent(new Be(t,{path:n,detail:{value:l}},e))}return l}if(!1===o)return s[propertyKey]}(e,r,...n)):(1===n.length&&lt(r,n[0]),s=function(e,t){const{path:n}=e,{mutatorEvents:s}=t;return s&&s.get&&e.dispatchEvent(new Be("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},set:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(3===n.length&&ft(r,n[2]),s=function(e,t,n,s){const r=Object.assign({},t),i="set",o=r.assignArray||"set",{target:a,path:c,schema:l}=e,{enableValidation:u,mutatorEvents:p,pathkey:h,recursive:d,subpathError:f,validationEvents:g,source:v}=r;if(!0===h){const t=n.split(new RegExp(pt.quotationEscape)),h=t.shift();let y;const b=dt(s),m=c?[c,h].join("."):String(h);if(t.length){if(d&&void 0===a[h]){let t,n;t="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[h].type.value:void 0,n="array"===b?[]:"object"===b||isNaN(Number(h))?{}:[];const s=ut({},r,{path:m,parent:e});y=new e.constructor(n,t,s)}else y=a[h];if(!1===f&&void 0===y)return;return"array"===y.type?["push","unshift"].includes(o)?y[o](...s):y[o](s):"object"===y.type&&y[i](t.join("."),s,r),y}if(l&&u){const t=e.valueOf(),n=v||ht(t),r=l.validateProperty(h,s,n,t);if(g){let t,n;r.valid?(t="validProperty",n=["validProperty",h].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",h].join(":"));for(const s of[t,n])e.dispatchEvent(new Ke(s,r,e))}if(!r.valid)return}if(s&&"object"==typeof s){s instanceof e.constructor&&(s=s.valueOf());const t=dt(s);let n,c;n="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[h].type.value:void 0,c="array"===t?[]:"object"===t||isNaN(Number(h))?{}:[];const u=ut({},r,{path:m,parent:e});y=new e.constructor(c,n,u),a[h]=y,e.retroReenableEvents(),"array"===y.type?["push","unshift"].includes(o)?y[o](...s):y[o](s):"object"===y.type&&y[i](s)}else y=s,a[h]=y;const j=y.valueOf();if(p){const t=c?[c,h].join("."):String(h);if(p.setProperty&&e.dispatchEvent(new Be("setProperty",{path:t,value:j,detail:{key:h,value:j}},e)),p["setProperty:$key"]){const n=["setProperty",h].join(":");e.dispatchEvent(new Be(n,{path:t,value:j,detail:{value:j}},e))}}return y}if(!1===h){let t=n;if(s&&"object"==typeof s){s instanceof e.constructor&&(s=s.valueOf());const n=dt(s);let u,p;"array"===l?.type&&(u=l.target[0].type.value),u="object"===l?.type?l.target[t].type.value:void 0,p="array"===n?[]:"object"===n||isNaN(Number(t))?{}:[];const h=c?[c,t].join("."):String(t),d=ut({},r,{path:h,parent:e});propertyValue=new e.constructor(p,u,d),a[t]=propertyValue,e.retroReenableEvents(),"array"===propertyValue.type?["push","unshift"].includes(o)?propertyValue[o](...s):propertyValue[o](s):"object"===propertyValue.type&&propertyValue[i](s)}else propertyValue=s,a[t]=propertyValue;if(p){const n=c?[c,t].join("."):String(t);if(p.setProperty&&e.dispatchEvent(new Be("setProperty",{path:n,value:_propertyValue,detail:{key:t,value:_propertyValue}},e)),p["setProperty:$key"]){const s=["setProperty",t].join(":");e.dispatchEvent(new Be(s,{path:n,value:_propertyValue,detail:{value:_propertyValue}},e))}}return propertyValue}}(e,r,...n)):(2===n.length&&ft(r,n[1]),s=function(e,t,n){const{path:s,schema:r}=e;let{enableValidation:i,mutatorEvents:o,required:a,validationEvents:c}=t;for(const[s,r]of Object.entries(n))e.set(s,r,Object.assign(t,{source:n}));return o&&o.set&&e.dispatchEvent(new Be("set",{path:s,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},delete:function(e,t,...n){let s;const r=t;return"string"==typeof n[0]?(2===n.length&&vt(r,n[1]),s=function(e,t,n){const{target:s,path:r,schema:i}=e,{mutatorEvents:o,pathkey:a,subpathError:c,enableValidation:l,validationEvents:u}=t;if(!0!==a)if(!1!==a);else{const a=n,c=s[a];if(i&&l){const t=e.valueOf();delete t[a];const n=i.validate(a,t,e.valueOf());if(u){let t,s;n.valid?(t="validProperty",s=["validProperty",a].join(":")):(t="nonvalidProperty",s=["nonvalidProperty",a].join(":"));for(const r of[t,s])e.dispatchEvent(new Ke(r,n,e))}if(!n.valid)return}if(c instanceof e.constructor&&c.delete(t),delete s[a],o&&(o.deleteProperty&&e.dispatchEvent(new Be("deleteProperty",{path:r,value:c,detail:{key:a,value:c}},e)),o["deleteProperty:$key"])){const t=["deleteProperty",a].join(":"),n=[r,a].join(".");e.dispatchEvent(new Be(t,{path:n,value:c,detail:{value:c}},e))}}else{const a=n.split(new RegExp(gt.quotationEscape)),p=a.shift();let h=s[p];if(a.length){if(!1===c&&void 0===h)return;return h.delete(a.join("."),t)}if(i&&l){const t=e.valueOf();delete t[p];const n=i.validate(p,t,{},e.valueOf());if(u){let t,s;const i=r?[r,p].join("."):String(p);n.valid?(t="validProperty",s=["validProperty",p].join(":")):(t="nonvalidProperty",s=["nonvalidProperty",p].join(":"));for(const r of[t,s])e.dispatchEvent(new Ke(r,Object.assign(n,{path:i}),e))}if(!n.valid)return}if(h&&"object"==typeof h&&h.delete(t),delete s[p],o&&(o.deleteProperty&&e.dispatchEvent(new Be("deleteProperty",{path:r,value:h,detail:{key:p,value:h}},e)),o["deleteProperty:$key"])){const t=["deleteProperty",p].join(":"),n=[r,p].join(".");e.dispatchEvent(new Be(t,{path:n,value:h,detail:{value:h}},e))}}}(e,r,...n)):(1===n.length&&vt(r,n[0]),s=function(e,t){const{target:n}=e;for(const[s,r]of Object.entries(n))e.delete(s,t);const{path:s}=e,{mutatorEvents:r}=t;return r&&r.delete&&e.dispatchEvent(new Be("delete",{path:s,detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s}};const{recursiveAssign:bt,recursiveFreeze:mt}=k,jt=Object.freeze({object:[{keys:["valueOf"],methodDescriptor:function(e,t){return{value:function(){return t.parse({type:"object"})}}}},{keys:["toString"],methodDescriptor:function(e,t){return{value:function(e={}){const n=void 0!==e.replacer?e.replacer:null,s=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:s})}}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],methodDescriptor:function(e,t){return{value:Object[e].bind(null,t.valueOf())}}},{keys:["propertyIsEnumerable","hasOwnProperty"],methodDescriptor:function(e,t){return{value:()=>t.parse({type:"object"})[e]}}},{type:"mutators",keys:Object.keys(Xe),methodDescriptor:function(e,t,n){return{value:Xe[e].bind(null,t,n)}}}],array:[{keys:["length"],methodDescriptor:function(e,t,n){return{get:()=>t.target.length,set(e){t.target.length=e}}}},{keys:["from","fromAsync","isArray","of"],methodDescriptor:function(e,t){return{value:Array[e]}}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],methodDescriptor:function(e,t){return{value:Array.prototype[e].bind(null,t)}}},{type:"mutators",keys:Object.keys(at),methodDescriptor:function(e,t,n){return{value:at[e].bind(null,t,n)}}}],map:[{type:"mutators",keys:Object.keys(yt),methodDescriptor:function(e,t,n){return{value:yt[e].bind(null,t,n)}}}]});const{recursiveAssign:Ot,typedObjectLiteral:Et}=k,wt=Object.freeze(["push","unshift"]),Pt=Object.freeze(["assign","defineProperties","set"]);const{typedObjectLiteral:xt,typeOf:kt}=k;let St=class e extends z{constructor(t={},n=null,s={}){super({propertyDirectory:{accessors:[(e,t)=>void 0===t?e.target:e.get(t)]}});const r=t instanceof e?t.valueOf():t;let i=null,o=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,s=n?n.split(".").pop():n;i&&i.unmount(s),i=t,o=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{options:{configurable:!0,get(){const e=(e=>Me({path:null,parent:null,enableEvents:!1,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,assignObject:"set",assignArray:"set",methods:{map:{get:{mutatorEvents:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,mutatorEvents:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{mutatorEvents:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{mutatorEvents:{"concatElement:$index":!0,concatElement:!0,concat:!0}},copyWithin:{mutatorEvents:{"copyWithinElement:$index":!0,copyWithinElement:!0,copyWithin:!0}},fill:{lengthen:!0,mutatorEvents:{"fillElement:$index":!0,fillElement:!0,fill:!0}},pop:{mutatorEvents:{pop:!0}},push:{mutatorEvents:{"pushElement:$index":!0,pushElement:!0,push:!0}},reverse:{mutatorEvents:{reverse:!0}},shift:{mutatorEvents:{shift:!0}},splice:{mutatorEvents:{"spliceDeleteElement:$index":!0,spliceDeleteElement:!0,"spliceAddElement:$index":!0,spliceAddElement:!0,splice:!0}},unshift:{mutatorEvents:{"unshiftElement:$index":!0,unshiftElement:!0,unshift:!0}}},object:{assign:{sourceTree:!0,mutatorEvents:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,mutatorEvents:{defineProperties:!0}},defineProperty:{descriptorTree:!0,mutatorEvents:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,mutatorEvents:{freezeProperty:!0,freeze:!0}},seal:{recursive:!0,mutatorEvents:{sealProperty:!0,seal:!0}}}}},e))(s);if(e.events&&(this.addEvents(e.events),delete e.events),e.enableEvents){const t=typeof e.enableEvents;"boolean"===t?this.enableEvents():"object"===t&&this.enableEvents(e.enableEvents)}return Object.defineProperty(this,"options",{value:e}),e}},parent:{get:()=>i},path:{get:()=>o},key:{get:()=>o?o.pop():o},target:{configurable:!0,get(){const e=xt(r);return Object.defineProperty(this,"target",{value:e}),e}},type:{configurable:!0,get(){const e=kt(this.target);return Object.defineProperty(this,"type",{value:e}),e}},schema:{configurable:!0,get(){const e=kt(n);let t;return["undefined","null"].includes(e)?t=null:n instanceof Ve?t=n:["array","object"].includes(e)&&(t=new Ve(n)),Object.defineProperty(this,"schema",{value:t}),t}}}),this.mount({parent:this.options.parent,path:this.options.path}),function(e){for(const[t,n]of Object.entries(jt))for(const s of n){const{keys:n,methodDescriptor:r,type:i}=s;for(const s of n)if("map"===t||"mutators"===i){const n=structuredClone(e.options.methods[t][s]),i=Object.assign({},e.options,n);delete i.mutatorEvents,i.mutatorEvents=n.mutatorEvents,Object.defineProperty(e,s,r(s,e,i))}else Object.defineProperty(e,s,r(s,e))}}(this),function(e,t,n){const{type:s}=e,{assignObject:r,assignArray:i}=n;"array"===s&&wt.includes(i)?e[i](...t):["array","object"].includes(s)&&Pt.includes(r)&&e[r](t)}(this,r,this.options)}retroReenableEvents(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}parse(t={type:"object",replacer:null,space:0}){let n=xt(this.type);for(const[t,s]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){let{enumerable:r,value:i,writable:o,configurable:a}=s;i instanceof e?Object.defineProperty(n,t,{enumerable:r,value:i.valueOf(),writable:o,configurable:a}):Object.defineProperty(n,t,{enumerable:r,value:i,writable:o,configurable:a})}let{type:s,replacer:r,space:i}=t;return"object"===s?n:"string"===s?JSON.stringify(n,r,i):void 0}};class At extends EventTarget{#E=localStorage;#w;constructor(e){super(),this.path=e}get path(){return this.#w}set path(e){void 0===this.#w&&(this.#w=e)}get(){try{return JSON.parse(this.#E.getItem(this.path))}catch(e){console.error(e)}}set(e){try{return this.#E.setItem(this.path,JSON.stringify(e))}catch(e){console.error(e)}}remove(){try{return this.#E.removeItem(this.path)}catch(e){console.error(e)}}}class $t extends St{#P;constructor(e,t,n){super(...arguments)}get localStorage(){if(void 0!==this.#P)return this.#P;const{localStorage:e}=this.options;let t;return e&&("string"==typeof e?t="/"!==t[0]?"/".concat(t):e:!0===e&&(t=[window.location.pathname],this.path&&t.push(t),t=t.join("")),void 0!==t&&(this.#P=new At(t))),this.#P}save(){return this.localStorage?(this.localStorage.set(this.content.valueOf()),this.localStorage.get()):null}load(){return this.localStorage?(this.content.set(this.localStorage.get()),this.localStorage.get()):null}unload(){return this.localStorage?this.localStorage.remove():null}}const Tt={attribute:/\[\s*(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)\s*(?:(?<operator>\W?=)\s*(?<value>.+?)\s*(\s(?<caseSensitive>[iIsS]))?\s*)?\]/gu,id:/#(?<name>[-\w\P{ASCII}]+)/gu,class:/\.(?<name>[-\w\P{ASCII}]+)/gu,comma:/\s*,\s*/g,combinator:/\s*[\s>+~]\s*/g,"pseudo-element":/::(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>¶*)\))?/gu,"pseudo-class":/:(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>¶*)\))?/gu,universal:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?\*/gu,type:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)/gu},Ct=new Set(["combinator","comma"]),_t=new Set(["not","is","where","has","matches","-moz-any","-webkit-any","nth-child","nth-last-child"]),Rt=/(?<index>[\dn+-]+)\s+of\s+(?<subtree>.+)/,Lt={"nth-child":Rt,"nth-last-child":Rt},Dt=e=>{switch(e){case"pseudo-element":case"pseudo-class":return new RegExp(Tt[e].source.replace("(?<argument>¶*)","(?<argument>.*)"),"gu");default:return Tt[e]}};function qt(e,t){let n=0,s="";for(;t<e.length;t++){const r=e[t];switch(r){case"(":++n;break;case")":--n}if(s+=r,0===n)return s}return s}const It=/(['"])([^\\\n]+?)\1/g,Vt=/\\./g;function Nt(e,t=Tt){if(""===(e=e.trim()))return[];const n=[];e=(e=e.replace(Vt,((e,t)=>(n.push({value:e,offset:t}),"".repeat(e.length))))).replace(It,((e,t,s,r)=>(n.push({value:e,offset:r}),`${t}${"".repeat(s.length)}${t}`)));{let t,s=0;for(;(t=e.indexOf("(",s))>-1;){const r=qt(e,t);n.push({value:r,offset:t}),e=`${e.substring(0,t)}(${"¶".repeat(r.length-2)})${e.substring(t+r.length)}`,s=t+r.length}}const s=function(e,t=Tt){if(!e)return[];const n=[e];for(const[e,s]of Object.entries(t))for(let t=0;t<n.length;t++){const r=n[t];if("string"!=typeof r)continue;s.lastIndex=0;const i=s.exec(r);if(!i)continue;const o=i.index-1,a=[],c=i[0],l=r.slice(0,o+1);l&&a.push(l),a.push({...i.groups,type:e,content:c});const u=r.slice(o+c.length+1);u&&a.push(u),n.splice(t,1,...a)}let s=0;for(const e of n)switch(typeof e){case"string":throw new Error(`Unexpected sequence ${e} found at index ${s}`);case"object":s+=e.content.length,e.pos=[s-e.content.length,s],Ct.has(e.type)&&(e.content=e.content.trim()||" ")}return n}(e,t),r=new Set;for(const e of n.reverse())for(const t of s){const{offset:n,value:s}=e;if(!(t.pos[0]<=n&&n+s.length<=t.pos[1]))continue;const{content:i}=t,o=n-t.pos[0];t.content=i.slice(0,o)+s+i.slice(o+s.length),t.content!==i&&r.add(t)}for(const e of r){const t=Dt(e.type);if(!t)throw new Error(`Unknown token type: ${e.type}`);t.lastIndex=0;const n=t.exec(e.content);if(!n)throw new Error(`Unable to parse content for ${e.type}: ${e.content}`);Object.assign(e,n.groups)}return s}function zt(e,{list:t=!0}={}){if(t&&e.find((e=>"comma"===e.type))){const t=[],n=[];for(let s=0;s<e.length;s++)if("comma"===e[s].type){if(0===n.length)throw new Error("Incorrect comma at "+s);t.push(zt(n,{list:!1})),n.length=0}else n.push(e[s]);if(0===n.length)throw new Error("Trailing comma");return t.push(zt(n,{list:!1})),{type:"list",list:t}}for(let t=e.length-1;t>=0;t--){let n=e[t];if("combinator"===n.type){let s=e.slice(0,t),r=e.slice(t+1);return 0===s.length?{type:"relative",combinator:n.content,right:zt(r)}:{type:"complex",combinator:n.content,left:zt(s),right:zt(r)}}}switch(e.length){case 0:throw new Error("Could not build AST.");case 1:return e[0];default:return{type:"compound",list:[...e]}}}function*Mt(e,t){switch(e.type){case"list":for(let t of e.list)yield*Mt(t,e);break;case"complex":yield*Mt(e.left,e),yield*Mt(e.right,e);break;case"relative":yield*Mt(e.right,e);break;case"compound":yield*e.list.map((t=>[t,e]));break;default:yield[e,t]}}function Bt(e,{recursive:t=!0,list:n=!0}={}){const s=Nt(e);if(!s)return;const r=zt(s,{list:n});if(!t)return r;for(const[e]of Mt(r)){if("pseudo-class"!==e.type||!e.argument)continue;if(!_t.has(e.name))continue;let t=e.argument;const n=Lt[e.name];if(n){const s=n.exec(t);if(!s)continue;Object.assign(e,s.groups),t=s.groups.subtree}t&&Object.assign(e,{subtree:Bt(t,{recursive:!0,list:!0})})}return r}function Ut(e){if(Array.isArray(e))return e.map((e=>e.content)).join("");switch(e.type){case"list":return e.list.map(Ut).join(",");case"relative":return e.combinator+Ut(e.right);case"complex":return Ut(e.left)+e.combinator+Ut(e.right);case"compound":return e.list.map(Ut).join("");default:return e.content}}class Kt{#x;#t;constructor(e){this.#x=e}get context(){return this.#x.context}get method(){return this.#x.method}get name(){return this.#x.name}get selector(){return this.#x.selector}get enable(){return this.#t}set enable(e){if(e!==this.#t){if(!0===e){const{context:e,name:t,method:n,selector:s}=this;Object.defineProperty(e.querySelectors,t,{configurable:!0,enumerable:!0,get:()=>e[n](s)})}else!1===e&&delete this.context.querySelectors[this.name];this.#t=e}}}const Ft=" ",Wt=">",Ht="~",Qt="+";function Jt(e,t,n){let s=[],r=n,i=Nt(r);":scope"!==i[0].content&&(r=[":scope",r].join(" "),i=Nt(r)),i[0];const o=i[1],a=Ut(i.slice(2));Nt(a);const c=Bt(a),l=Array.from(e.children);for(const[n,r]of Object.entries(l)){if("complex"===c.type){const{left:i,combinator:o,right:a}=c;let u;Jt(e,t,Ut(i)).length&&(o===Ft?(u=Jt(r,t,[":scope",Ut(a)].join(Ft)),s=s.concat(u)):o===Wt?(u=Jt(r,t,[":scope",Ut(a)].join(Wt)),s=s.concat(u)):o===Ht?(u=Jt({children:l.slice(n+1)},t,Ut(a)),s=s.concat(u)):o===Qt&&(u=Jt({children:l.slice(n+1,n+2)},t,Ut(a)),s=s.concat(u)))}else if(r.matches(a)&&(s=s.concat(r)),o.content===Ft){const e=r[t](a);e instanceof NodeList?s=s.concat(...e):e instanceof Node&&(s=s.concat(e))}if("querySelector"===t&&s.length>0)return s.slice(0,1)}return s}class Gt extends he{#k;#S;#A;#$;#T;constructor(e={},t={}){super((e=>ne({scope:"template",templates:{},querySelectors:{}},e))(e),(e=>Object.assign({events:!1,eventListeners:!1,enableEvents:!0,enableQuerySelectors:!0},e))(t)),Object.defineProperties(this,{_querySelectors:{enumerable:!1,writable:!1,configurable:!1,value:{}},querySelectors:{enumerable:!0,get(){return this._querySelectors}},qs:{enumerable:!0,get(){return this.querySelectors}}}),this.addQuerySelectors(this.settings.querySelectors);const{enableQuerySelectors:n,enableEvents:s}=this.options;n&&this.enableQuerySelectors(),s&&this.enableEvents()}get templates(){return void 0!==this.#k||(this.#k=this.settings.templates),this.#k}get scope(){return void 0!==this.#S||(this.#S=this.settings.scope),this.#S}get parentElement(){return void 0!==this.#A||(this.#A=this.settings.parentElement),this.#A}get#C(){return void 0!==this.#$||(this.#$=document.createElement("template")),this.#$}set#C(e){this.disableQuerySelectors(),this.#C.innerHTML=e,this.children=this.#C.content.children,this.parentElement.append(...this.children.values()),this.enableQuerySelectors(),this.retroReenableEvents()}get children(){return void 0!==this.#T||(this.#T=new Map),this.#T}set children(e){const t=this.children;t.forEach(((e,t)=>e?.parentElement.removeChild(e))),t.clear(),Array.from(e).forEach(((e,n)=>{t.set(n,e)}))}querySelector(e,t){return this.#_("querySelector",e,t)[0]||null}querySelectorAll(e,t){return this.#_("querySelectorAll",e,t)}#_(e,t){return Jt("template"===this.scope?{children:Array.from(this.children.values())}:{children:Array.from(this.parentElement.children)},e,t)}addQuerySelectors(e){if(void 0===e)return this;const{querySelectors:t}=this.settings;for(const[n,s]of Object.entries(e))for(const[e,r]of Object.entries(s))t[n]=t[n]||{},t[n][e]=new Kt({context:this,name:e,method:n,selector:r,enable:!1});return this}removeQuerySelectors(e){e=e||this.settings.querySelectors;for(const[t,n]of Object.entries(e))for(const[e,s]of Object.entries(n))void 0!==this.settings.querySelectors[t]&&delete this.settings.querySelectors[t][e];return this}enableQuerySelectors(e){e=e||this.settings.querySelectors;for(const t of Object.values(e))for(const e of Object.values(t))e.enable=!0;return this}disableQuerySelectors(e){e=e||this.settings.querySelectors;for(const t of Object.values(e))for(const e of Object.values(t))e.enable=!1;return this}render(e={},t="default"){return this.#C=this.templates[t](e),this}}const Xt={ok:(e,t)=>new CustomEvent(`${t}:ok`,{detail:{response:e}}),status:(e,t)=>new CustomEvent(`${t}:status`,{detail:{response:e}}),statusCode:(e,t)=>{const n=`${t}:status:${e.status}`;return new CustomEvent(n,{detail:{response:e}})},statusText:(e,t)=>new CustomEvent(`${t}:statusText`,{detail:{response:e}}),statusTextMessage:(e,t)=>{const n=`${t}:statusText:${e.statusText}`;return new CustomEvent(n,{detail:{response:e}})},abort:e=>new CustomEvent("abort",{detail:{abortController:e}})};class Yt extends EventTarget{#x={};#R;#L;#w;constructor(e={}){super(),this.#x=e,this.#R=this.#x.name,this.#L=this.#x.origin,this.#w=this.#x.path,this.addMethods(this.#x.methods)}addMethods(e){const t=this;for(const[n,s]of Object.entries(e)){const e=`${n}AbortSignal`;Object.defineProperties(t,{[e]:{enumerable:!1,writable:!0,value:void 0},[n]:{enumerable:!0,writable:!1,configurable:!1,value:async function(){const r=[...arguments];let i,o;0===r.length?(i="",o={}):1===r.length?"string"==typeof r[0]?(i=r[0],o={}):"object"==typeof r[0]&&(i="",o=r[0]):2===r.length&&("string"==typeof r[0]&&(i=r[0]),"object"==typeof r[1]&&(o=r[1]));const a=Object.assign({},s);let{urlSearchParams:c,headers:l,body:u,priority:p}=o,h=new URLSearchParams(c).toString();h.length>0&&(h="?".concat(h)),void 0!==l&&Object.assign(a.headers,l),void 0!==u&&(a.body=u),void 0!==p&&(a.priority=p);const d=String.prototype.concat(t.#L,this.#D(t.#w,i),h);return void 0!==t[e]&&(t[e].abort(),t.createEvent(t,"abort",t[e])),t[e]=new AbortController,a.signal=t[e].signal,await fetch(d,a).then((e=>(t.createEvent(t,"ok",e.clone(),n).createEvent(t,"status",e.clone(),n).createEvent(t,"statusCode",e.clone(),n).createEvent(t,"statusText",e.clone(),n).createEvent(t,"statusTextMessage",e.clone(),n),e))).catch((e=>{}))}}})}}#D(e,t){if(!1===e.includes(":"))return e;const n=e.split("/"),s=t.split("/");if(n.length!==s.length)return e;let r=[],i=0;for(;i<n.length;){let t=n[i];const o=s[i];if(t.includes(":"))t=s[i];else if(t!==o)return e;r.push(t),i++}return r.join("/")}removeMethods(e){for(const t of Object.values(e)){const e=`${t}AbortSignal`;!1===this[e].signal.aborted&&this[e].abort(),delete this[e],delete this[t]}}createEvent(e,t,n,s){const r=Xt[t](n,s);return e.dispatchEvent(r),this}}class Zt extends he{#q;#I;#V;#N;#z;#M={};constructor(e,t){super((e=>Object.assign({},e))(e),(e=>Object.assign({enableEvents:!0},e))(t));const{scheme:n,domain:s,port:r,routes:i}=e;this.#q=n,this.#I=s,this.#V=r,this.routes=i,!0===t.enableEvents&&this.enableEvents()}get#B(){return void 0===this.#N&&(this.#N=String.prototype.concat(this.#I,":",this.#V)),this.#N}get#L(){return void 0===this.#z&&(this.#z=String.prototype.concat(this.#q,"://",this.#B)),this.#z}get routes(){return this.#M}set routes(e){this.addRoutes(e)}addRoutes(e){const t=this.#M;for(let[n,s]of Object.entries(e))s.origin=this.#L,s.path=n,t[s.name]=new Yt(s);return this}removeRoutes(e){const t=this.#M;for(const n of e)delete t[n];return this}}var en,tn={};var nn=function(){if(en)return tn;en=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.TokenData=void 0,tn.parse=l,tn.compile=function(t,n={}){const{encode:s=encodeURIComponent,delimiter:r=e}=n,i=u((t instanceof c?t:l(t,n)).tokens,r,s);return function(e={}){const[t,...n]=i(e);if(n.length)throw new TypeError(`Missing parameters: ${n.join(", ")}`);return t}},tn.match=function(n,s={}){const{decode:r=decodeURIComponent,delimiter:i=e}=s,{regexp:o,keys:a}=p(n,s),c=a.map((e=>!1===r?t:"param"===e.type?r:e=>e.split(i).map(r)));return function(e){const t=o.exec(e);if(!t)return!1;const n=t[0],s=Object.create(null);for(let e=1;e<t.length;e++){if(void 0===t[e])continue;const n=a[e-1],r=c[e-1];s[n.name]=r(t[e])}return{path:n,params:s}}},tn.pathToRegexp=p,tn.stringify=function(e){return e.tokens.map((function e(t,r,i){if("text"===t.type)return t.value.replace(/[{}()\[\]+?!:*]/g,"\\$&");if("group"===t.type)return`{${t.tokens.map(e).join("")}}`;const o=function(e){const[t,...r]=e;return!!n.test(t)&&r.every((e=>s.test(e)))}(t.name)&&function(e){return"text"!==(null==e?void 0:e.type)||!s.test(e.value[0])}(i[r+1]),a=o?t.name:JSON.stringify(t.name);if("param"===t.type)return`:${a}`;if("wildcard"===t.type)return`*${a}`;throw new TypeError(`Unexpected token: ${t}`)})).join("")};const e="/",t=e=>e,n=/^[$_\p{ID_Start}]$/u,s=/^[$\u200c\u200d\p{ID_Continue}]$/u,r="https://git.new/pathToRegexpError",i={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function o(e){return e.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}class a{constructor(e){this.tokens=e}peek(){if(!this._peek){const e=this.tokens.next();this._peek=e.value}return this._peek}tryConsume(e){const t=this.peek();if(t.type===e)return this._peek=void 0,t.value}consume(e){const t=this.tryConsume(e);if(void 0!==t)return t;const{type:n,index:s}=this.peek();throw new TypeError(`Unexpected ${n} at ${s}, expected ${e}: ${r}`)}text(){let e,t="";for(;e=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)t+=e;return t}}class c{constructor(e){this.tokens=e}}function l(e,o={}){const{encodePath:l=t}=o,u=new a(function*(e){const t=[...e];let o=0;function a(){let e="";if(n.test(t[++o]))for(e+=t[o];s.test(t[++o]);)e+=t[o];else if('"'===t[o]){let n=o;for(;o<t.length;){if('"'===t[++o]){o++,n=0;break}e+="\\"===t[o]?t[++o]:t[o]}if(n)throw new TypeError(`Unterminated quote at ${n}: ${r}`)}if(!e)throw new TypeError(`Missing parameter name at ${o}: ${r}`);return e}for(;o<t.length;){const e=t[o],n=i[e];if(n)yield{type:n,index:o++,value:e};else if("\\"===e)yield{type:"ESCAPED",index:o++,value:t[o++]};else if(":"===e){const e=a();yield{type:"PARAM",index:o,value:e}}else if("*"===e){const e=a();yield{type:"WILDCARD",index:o,value:e}}else yield{type:"CHAR",index:o,value:t[o++]}}return{type:"END",index:o,value:""}}(e));const p=function e(t){const n=[];for(;;){const s=u.text();s&&n.push({type:"text",value:l(s)});const r=u.tryConsume("PARAM");if(r){n.push({type:"param",name:r});continue}const i=u.tryConsume("WILDCARD");if(i){n.push({type:"wildcard",name:i});continue}if(!u.tryConsume("{"))return u.consume(t),n;n.push({type:"group",tokens:e("}")})}}("END");return new c(p)}function u(e,n,s){const r=e.map((e=>function(e,n,s){if("text"===e.type)return()=>[e.value];if("group"===e.type){const t=u(e.tokens,n,s);return e=>{const[n,...s]=t(e);return s.length?[""]:[n]}}const r=s||t;if("wildcard"===e.type&&!1!==s)return t=>{const s=t[e.name];if(null==s)return["",e.name];if(!Array.isArray(s)||0===s.length)throw new TypeError(`Expected "${e.name}" to be a non-empty array`);return[s.map(((t,n)=>{if("string"!=typeof t)throw new TypeError(`Expected "${e.name}/${n}" to be a string`);return r(t)})).join(n)]};return t=>{const n=t[e.name];if(null==n)return["",e.name];if("string"!=typeof n)throw new TypeError(`Expected "${e.name}" to be a string`);return[r(n)]}}(e,n,s)));return e=>{const t=[""];for(const n of r){const[s,...r]=n(e);t[0]+=s,t.push(...r)}return t}}function p(t,n={}){const{delimiter:s=e,end:r=!0,sensitive:i=!1,trailing:a=!0}=n,u=[],p=[],f=i?"":"i",g=(Array.isArray(t)?t:[t]).map((e=>e instanceof c?e:l(e,n)));for(const{tokens:e}of g)for(const t of h(e,0,[])){const e=d(t,s,u);p.push(e)}let v=`^(?:${p.join("|")})`;a&&(v+=`(?:${o(s)}$)?`),v+=r?"$":`(?=${o(s)}|$)`;return{regexp:new RegExp(v,f),keys:u}}function*h(e,t,n){if(t===e.length)return yield n;const s=e[t];if("group"===s.type){const r=n.slice();for(const n of h(s.tokens,0,r))yield*h(e,t+1,n)}else n.push(s);yield*h(e,t+1,n)}function d(e,t,n){let s="",i="",a=!0;for(let c=0;c<e.length;c++){const l=e[c];if("text"!==l.type)if("param"!==l.type&&"wildcard"!==l.type);else{if(!a&&!i)throw new TypeError(`Missing text after "${l.name}": ${r}`);"param"===l.type?s+=`(${f(t,a?"":i)}+)`:s+="([\\s\\S]+)",n.push(l),i="",a=!1}else s+=o(l.value),i+=l.value,a||(a=l.value.includes(t))}return s}function f(e,t){return t.length<2?e.length<2?`[^${o(e+t)}]`:`(?:(?!${o(e)})[^${o(t)}])`:e.length<2?`(?:(?!${o(t)})[^${o(e)}])`:`(?:(?!${o(t)}|${o(e)})[\\s\\S])`}return tn.TokenData=c,tn}();class sn extends EventTarget{#U;#t;#K;#F;constructor(e={}){super(),this.#x=e}get#x(){return this.#U}set#x(e){this.#U=e;for(const[t,n]of Object.entries(e))Object.defineProperty(this,t,{value:n})}get pathname(){return this.#x.pathname}get enable(){return void 0!==this.#t||(void 0!==this.#x.enable?this.#t=this.#x.enable:this.#t=!0),this.#t}set enable(e){this.#t!==e&&(this.#t=e)}get active(){return void 0!==this.#K||void 0===this.#x.active&&(this.#K=!1),this.#K}set active(e){this.#K!==e&&(this.#K=e)}get match(){return void 0!==this.#F||(this.#F=nn.match(this.pathname)),this.#F}}class rn extends CustomEvent{#W;constructor(e,t){super(e,t),this.#W=t}get path(){return this.#W.path}get route(){return this.#W.route}get location(){return this.#W.location}}class on extends he{#H;#Q;#M;#J;#G;#t;#X={windowLocationOrigin:new RegExp(`^${this.window.location.origin}`)};constructor(e,t){super((e=>Object.assign({routes:{}},e))(e),(e=>Object.assign({enableEvents:!0},e))(t)),!0===t.enableEvents&&this.enableEvents(),this.enable=!0}get base(){return this.settings.base}get window(){return void 0!==this.#H||(this.#H=window),this.#H}get hashpath(){return void 0!==this.#Q||(this.#Q=void 0!==this.settings.hashpath&&this.settings.hashpath),this.#Q}get routes(){if(void 0!==this.#M)return this.#M;this.#M={};const e=Object.entries(this.settings.routes);for(const[t,n]of e)this.setRoute(t,n);return this.#M}get location(){return this.#J}get route(){return this.#G}get enable(){return this.#t}set enable(e){if(this.#t===e)return;const t=this.#Y.bind(this);!0===e?this.#H.addEventListener("popstate",t):!1===e&&this.#H.removeEventListener("popstate",t),this.#t=e}#Y(){this.navigate()}navigate(e,t){if("string"==typeof e&&["assign","replace"].includes(t))return this.window?.location[t](e),this;let n,s;[this.window.origin,this.base].join(""),this.hashpath?(n=this.window.location.hash.slice(1),s=this.#Z(n)):(n=this.window.location.href.replace(new RegExp(`^${this.window.origin}`),"").replace(new RegExp(`^${this.base}`),""),s=this.#Z(n));const{route:r,location:i}=s,o={route:r,location:i,path:n},a=this.route;return a&&(a.active=!1),r&&r?.enable?(r.active=!0,i.state=this.window.history.state,i.base=this.base,i.pathname=this.window.location.pathname.replace(new RegExp(`^${this.base}`),""),i.hash=this.window.location.hash,i.search=this.window.location.search,delete i.path,this.#G=r,this.#J=i,this.dispatchEvent(new rn("route",o)),this.dispatchEvent(new rn(`route:${r.name}`,o))):(this.#G=null,this.#J=null,this.dispatchEvent(new rn("nonroute",o))),this}enableRoute(e){const t=this.getRoute(e);return t.enable=!0,t}disableRoute(e){const t=this.getRoute(e);return t.enable=!1,t}setRoute(e,t){const n=ne({pathname:t.pathname||e},t);return this.#M[e]=new sn(n),this.#M[e]}getRoute(e){return this.#M[e]}deleteRoute(e){return delete this.#M[e],this.#M[e]}#Z(e){const t=Object.entries(this.routes);let n=0,s=null,r=null;e:for(;n<t.length;){const[i,o]=t[n];if(r=o.match(e)||null,r){s=o;break e}n++}return{route:s,location:r}}}class an extends CustomEvent{#x;#ee;constructor(e,t,n){super(e,t),this.#x=t,this.#ee=n}get isBinary(){return this.#x.isBinary}get message(){return this.#x.message}get detail(){return this.#x.detail}}class cn extends EventTarget{#x;#te;#ne;constructor(e){super(),this.#x=e}get name(){return this.#x.name}get messages(){return void 0!==this.#te||(void 0!==this.#x.messages?this.#te=this.#x.messages:this.#te={}),this.#te}get message(){return void 0!==this.#ne||(this.#ne=this.#x.message),this.#ne}}class ln extends he{#se;#K=!1;#re;#ie;#oe;constructor(e={},t={}){super((e=>Object.assign({active:!1},e))(e),(e=>Object.assign({events:!1,enableEvents:!0},e))(t)),this.#oe=this.#ne.bind(this),Object.defineProperties(this,{webSocket:{enumerable:!0,get(){return void 0!==this.#se||(this.#se=new WebSocket(this.url),this.#se.addEventListener("message",this.#oe)),this.#se}}}),this.active=this.settings.active,!0===this.options.enableEvents&&this.enableEvents()}get active(){return this.#K}set active(e){this.#K!==e&&(!0===e?this.webSocket:!1===e&&(this.#se=void 0),this.#K=e)}get path(){return this.settings.path}get url(){if(void 0!==this.#ie)return this.#ie;let e,{protocol:t,host:n,port:s}=this.settings;return e=t&&n&&s?[t,"//",n,":",s].join(""):window.location.url.origin,this.#ie=new URL(this.path,e),this.#ie}#ne(e,t){for(const n of this.messageAdapters)try{const s=n.message(e,t),{type:r,detail:i}=s,o=new an(r,{detail:i,message:e,isBinary:t},this);this.webSocket.dispatchEvent(o)}catch(e){console.error(e)}}get messageAdapters(){if(void 0!==this.#re)return this.#re;const e=[];for(const t of this.settings.messageAdapters){let n;t instanceof cn||(n=new cn(t,this)),e.push(n)}return this.#re=e,this.#re}send(){this.webSocket.send(...arguments)}}function un(e,t,n,s){const r=s,i=e,o=e?.path?[e.path,s.name,t].join("."):[s.name,t].join(".");if(n&&dn.includes(n.constructor))n.mount({path:o,parent:i});else if(Array.isArray(n)){const{Class:e}=r;if(e===$t){let[t,s,a]=n;s=s||null,a=a||{},Object.assign(a,{definition:r,parent:i,path:o}),n=new e(t,s,a)}else if(dn.includes(e)){if(2===n.length){const[t,s]=n;Object.assign(s,{definition:r,parent:i,path:o}),n=new e(t,s)}if(1===n.length){const[t]=n;n=new e(t)}}}return n}function pn(e,t,n){}class hn extends he{static propertyClasses=[{name:"models",targetType:"Object",administer:"addModels",deadminister:"removeModels",instate:un,deinstate:pn,Class:$t},{name:"views",targetType:"Object",administer:"addViews",deadminister:"removeViews",instate:un,deinstate:pn,Class:Gt},{name:"locationRouters",targetType:"Object",administer:"addLocationRouters",deadminister:"removeLocationRouters",instate:un,deinstate:pn,Class:on},{name:"fetchRouters",targetType:"Object",administer:"addFetchRouters",deadminister:"removeFetchRouters",instate:un,deinstate:pn,Class:Zt},{name:"socketRouters",targetType:"Object",administer:"addSocketRouters",deadminister:"removeSocketRouters",instate:un,deinstate:pn,Class:ln},{name:"controls",targetType:"Object",administer:"addControls",deadminister:"removeControls",instate:un,deinstate:pn,Class:hn}];constructor(e={},t={}){super((e=>Object.assign({models:{},views:{},controls:{},fetchRouters:{},locationRouters:{}},e))(Object.assign({},e)),(e=>Object.assign({events:!1,enableEvents:!0},e))(Object.assign({propertyClasses:hn.propertyClasses},t)))}}const dn=[$t,Gt,hn,on,Zt,ln];var fn={default:(e,t)=>void 0===t?e:e[t],get:(e,t)=>void 0===t?e:e.get(t)};const gn={string:String,number:Number,boolean:Boolean,undefined:void 0,null:null},vn=Object.keys(gn),yn=Object.values(gn),bn={object:Object,array:Array},mn=Object.keys(bn),jn=Object.values(bn),On=Object.assign({},gn,bn),En=Object.keys(On),wn=Object.values(On),Pn=[gn.String,gn.Number,gn.Boolean,bn.Object,bn.Array];var xn=Object.freeze({__proto__:null,ObjectKeys:mn,ObjectValues:jn,Objects:bn,PrimitiveKeys:vn,PrimitiveValues:yn,Primitives:gn,TypeKeys:En,TypeMethods:Pn,TypeValues:wn,Types:On}),kn={quotationEscape:/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/};const Sn=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function An(e){return e.split(new RegExp(kn.quotationEscape))}function $n(e){const t=An(e);return t.pop(),t}function Tn(e){return An(e).pop()}function Cn(e){return An(e).shift()}function _n(e){return Number(Cn(e))?"array":"object"}function Rn(e){return{subpaths:An(e),keypaths:$n(e),key:Tn(e),root:Cn(e),typeofRoot:_n(e)}}function Ln(e){let t;const n=Sn(e);return"object"===n?t={}:"array"===n?t=[]:"string"===n?"object"===e?t={}:"array"===e&&(t=[]):t=void 0,t}function Dn(e,t){const n=e.split(new RegExp(kn.quotationEscape)),s=n.pop();let r=t;for(const e of n)r=r[e];return r[s]}function qn(e,t){const{keypaths:n,key:s,typeofRoot:r}=Rn(e),i=Ln(r);let o=i;for(const e of n)Number(e)?o[e]=[]:o[e]={},o=o[e];return o[s]=t,i}const In={depth:0,maxDepth:10,accessors:[fn.default]};var Vn=Object.freeze({__proto__:null,accessors:fn,expandEvents:function(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[s,r]of Object.entries(e)){const e=s.trim().split(" ");let i,o,a;1===e.length?(i=t,o=e[0]):e.length>1&&(i=e[0],o=e[1]),Array.isArray(r)?(a=r[0],r[1]):a=r;const c={type:o,path:i,listener:a,enable:!1};n.push(c)}return n},expandTree:function e(t,n){const s=Sn(n),r=Sn(t);if(!["string","function"].includes(s)||!["array","object"].includes(r))return t;let i=Ln(t);for(const[r,o]of Object.entries(t))"string"===s?i[r]=qn(n,o):"function"===s&&(i[r]=n(o)),i[r][n]&&"object"==typeof i[r][n]&&(i[r][n]=e(i[r][n],n));return i},impandTree:function e(t,n){const s=Sn(n),r=Sn(t);if(!["string","function"].includes(s)||!["array","object"].includes(r))return t;let i=Ln(t);for(const[r,o]of Object.entries(t))"string"===s?i[r]=Dn(n,o):"function"===s&&(i[r]=n(o)),i[r]&&"object"==typeof i[r]&&(i[r]=e(i[r],n));return i},propertyDirectory:function e(t,n){const s=[],r=Object.assign({},In,n);if(r.depth++,r.depth>r.maxDepth)return s;for(const n of r.accessors){const i=n(t);if(i)for(const[t,n]of Object.entries(i))if(r.values?r.values&&s.push([t,n]):s.push(t),"object"==typeof n&&null!==n&&n!==i){const i=e(n,r);if(r.values){if(r.values)for(const[e,n]of i){const r=[t,e].join(".");s.push([r,n])}}else for(const e of i){const n=[t,e].join(".");s.push(n)}}}return s},recursiveAssign:function e(t,...n){if(!t)return t;for(const s of n)if(s)for(const[n,r]of Object.entries(s)){const s=Sn(t[n]),i=Sn(r);t[n]="object"===s&&"object"===i?e(t[n],r):r}return t},recursiveAssignConcat:function e(t,...n){if(!t)return t;for(const s of n)if(s)for(const[n,r]of Object.entries(s)){const s=Sn(t[n]),i=Sn(r);t[n]="object"===s&&"object"===i?e(t[n],r):"array"===s&&"array"===i?t[n].concat(r):r}return t},recursiveFreeze:function e(t){for(const[n,s]of Object.entries(t))s&&"object"==typeof s&&e(s);return Object.freeze(t)},regularExpressions:kn,typeOf:Sn,typedObjectLiteral:Ln,variables:xn});class Nn extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}}const{typedObjectLiteral:zn}=Vn,Mn={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function Bn(e="expand",t){const n=t||this,s=n.schema,r=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=zn(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const r of s)t[n.key][r.type]={},r.validation?t[n.key][r.type]=this.report(e,r.validation):t[n.key][r.type]=r}return t}if("impand"===e){if(!1===n.valid)return!1;const t=zn(s.type);for(const n of r){const s=[].concat(n.advance,n.deadvance,n.unadvance);let r;e:for(const t of s)if("type"===t.type){t.validation&&n.valid&&(r=this.report(e,t.validation));break e}r||(r=n.valid),t[n.key]=r}return t}}class Un extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:Mn},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=Bn.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}}const{recursiveAssign:Kn}=Vn,Fn={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class Wn extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:Fn},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,s){const{definition:r,messages:i,type:o}=this;let a=new Nn({type:o,key:e,value:r.value,messages:Kn({},i,r.messages)});const c=r.validate(...arguments);return"object"==typeof c?(a.validation=c,a.pass=c.valid):a.pass=c,a}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}}const{recursiveAssign:Hn,typedObjectLiteral:Qn}=Vn,{typeOf:Jn,variables:Gn}=Vn,{ObjectKeys:Xn,TypeKeys:Yn}=Gn,{recursiveAssign:Zn}=Vn,{typedObjectLiteral:es,typeOf:ts,variables:ns}=Vn,{recursiveAssign:ss}=Vn,{recursiveAssign:rs,typedObjectLiteral:is}=Vn,{typedObjectLiteral:os}=Vn,{impandTree:as,recursiveAssign:cs,typedObjectLiteral:ls}=Vn,{typedObjectLiteral:us}=Vn,{typedObjectLiteral:ps}=Vn,{recursiveAssign:hs,typedObjectLiteral:ds,typeOf:fs}=Vn,{typedObjectLiteral:gs}=Vn,{recursiveAssign:vs,typedObjectLiteral:ys,typeOf:bs}=Vn,{regularExpressions:ms}=Vn,{recursiveAssign:js}=Vn,{recursiveAssign:Os,regularExpressions:Es,typedObjectLiteral:ws,typeOf:Ps}=Vn,{recursiveAssign:xs}=Vn,{regularExpressions:ks}=Vn,{recursiveAssign:Ss}=Vn,{recursiveAssign:As,recursiveFreeze:$s}=Vn,{recursiveAssign:Ts,typedObjectLiteral:Cs}=Vn,{typedObjectLiteral:_s,typeOf:Rs}=Vn;export{hn as Control,he as Core,ce as Coutil,Zt as FetchRouter,on as LocationRouter,cn as MessageAdapter,$t as Model,Ve as Schema,ln as SocketRouter,Un as Validation,Wn as Validator,Nn as Verification,Gt as View};
//# sourceMappingURL=mvc-framework.min.js.map
